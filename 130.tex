\SetTitle{13}{The Mermin--Peres game, part 1}{An always-win game only with quantum advantage}{13}

\section*{Introduction}



\begin{frame}{Introduction to the \href{https://en.wikipedia.org/wiki/Quantum_pseudo-telepathy\#The_Mermin\%E2\%80\%93Peres_magic_square_game}{Mermin--Peres magic square}}{This game is due to \href{https://en.wikipedia.org/wiki/N._David_Mermin}{David Mermin} and \href{https://en.wikipedia.org/wiki/Asher_Peres}{Asher Peres}}

\begin{itemize}[<+->]
    \item With CHSH, a quantum approach is probabilistically better than any classical approach but does not guarantee to win the game.
    \item The Mermin--Peres magic square is a puzzle that Alice and Bob can win at best $\frac{8}{9}$ of the time, but a quantum approach on a reliable quantum computer can always win.
    \item Alice and Bob share two EPR pairs, each initially in the state $\frac{\ket{00}+\ket{11}}{\sqrt{2}}$.
    \item Variations of the game we consider also go by the same name, and they are equivalent in difficulty and in the approach to a quantum-based solution.
    \item We follow the game as specified in the Wikipedia \href{https://en.wikipedia.org/wiki/Quantum_pseudo-telepathy\#The_Mermin\%E2\%80\%93Peres_magic_square_game}{article}.
    \item It is lacking in significant details.
\end{itemize}
    
\end{frame}



\section*{Magic square}


\begin{frame}{How is the game played?}
\Vskip{-3em}\TwoUnequalColumns{0.5\textwidth}{0.5\textwidth}{%
\begin{MPSquareEnv}
\only<1-6>{%
\begin{itemize}
    \item<1-> After enjoying some time together, Alice and Bob separate and cannot communicate with each other.
    \item<2-> A referee chooses a \textcolor{\RCone}{row number for Alice (2)} and a \textcolor{\RCtwo}{column number for Bob (1)}.
    \item<3-> Alice must respond with an entry for each cell of \textcolor{\RCone}{her designated row}, choosing~\PP{} or~\MM{}.
    \item<6-> The product of \textcolor{\RCone}{her entries} must be~\PP{}.
\end{itemize}}
\only<7->{%
\begin{itemize}
    \item<7-> Bob must do the same for \textcolor{\RCtwo}{his designated column}.
    \item<8-> Where the row and column \textcolor{Purple}{intersect}, Alice and Bob must agree on the value, or they lose.
    \item<10-> The product of \textcolor{\RCtwo}{his entries} must be~\MM{}.
\end{itemize}
}
\end{MPSquareEnv}
}{%
\begin{center}
\begin{MPSquareEnv}
\def\VS####1####2{\visible<####1>{####2}}
\MPSquare{\VS{7-}{\textcolor{\RCtwo}{\PP}}}{ }{ }{\only<3-7>{\VS{3-}{\textcolor{\RCone}{\PP}}}\only<8->{\VS{3-}{\textcolor{Purple}{\PP}}}}{\VS{4-}{\textcolor{\RCone}{\MM}}}{\VS{5-}{\textcolor{\RCone}{\MM}}}{\VS{9-}{\textcolor{\RCtwo}{\MM}}}{ }{ }
\end{MPSquareEnv}
\end{center}
}%
\end{frame}

\begin{frame}{Best classical solution}{They can agree to respond as shown on this slide, winning $8$ of $9$ games on average}

\Vskip{-3em}\TwoUnequalColumns{0.6\textwidth}{0.4\textwidth}{%
\begin{MPSquareEnv}
\only<1-6>{%
\begin{itemize}[<+->]
    \item Before separating, Alice and Bob can agree to respond as shown here.
    \item Let's verify that for the first two rows and columns, they always agree on the common value and the products are correct.
    \item For row or column three, Alice and Bob would have to complete their response in a way that creates the correct product.
    \begin{description}
      \item[\ColorOne{Alice}] must respond \ColorOne{\MM{}} so that her row's product is \PP{}.
      \item[\ColorTwo{Bob}] must respond \ColorTwo{\PP{}} so that his column's product is \MM{}.
    \end{description}
\end{itemize}}%
\only<7->{%
\begin{itemize}
    \item<7-> While other static solutions are possible, each would have at least one square where Alice and Bob cannot agree classically on an entry.
    \item<8-> As with previous games, we will use measurements of entangled qubits to influence choices made by \textit{incommunicado} Alice and Bob.
    \item<9-> With quantum computing, they can always win.
    \item<10-> But first let's rule out the possibility of any always-win classical solution.
\end{itemize}
}
\end{MPSquareEnv}
}{%
\Vskip{-3em}\begin{center}
\begin{MPSquareEnv}
\MPSquare{\PP{}}{\PP{}}{\PP{}}{\PP{}}{\MM{}}{\MM{}}{\MM{}}{\PP{}}{\only<1-3,6-8>{\alert{\textbf{?}}}\only<4>{\ColorOne{\MM{}}}\only<5>{\ColorTwo{\PP{}}}}
\end{MPSquareEnv}
\end{center}
\visible<6->{%
\alert{They lose only when \emph{both} the third row and column are designated, 1 of 9 possibilities.  Is there a way to win always?}}
}
    
\end{frame}

\begin{frame}{Proof of no static solution}{We cannot predetermine values in each cell that always work}

\Vskip{-3em}\TwoUnequalColumns{0.6\textwidth}{0.4\textwidth}{%
\begin{MPSquareEnv}
\Vskip{-3em}\begin{itemize}
    \item<1-> Each row's product is~\PP{} so the three rows' products is also~\PP{}.
    \item<2-> Each column's product is~\MM{} so the three columns' products is also~\MM{}.
    \item<3-> This is a contradiction.
\end{itemize}
\begin{align*}
    \visible<1>{a b c = d e f = g h k &= \PP{} \\}
    \visible<1,3>{\ColorOne{a b c \times d e f \times g h k} & = \PP{} \\}
    \visible<2>{a d g = b e h = c f k &= \MM{} \\}
    \visible<2->{\ColorTwo{a d g \times b e h \times c f k} & = \MM{} \\}
    \visible<3->{\ColorOne{abcdefghk} & \neq \ColorTwo{abcdefghk}}
\end{align*}
\visible<3->{\Vskip{-4em}\QED}
\end{MPSquareEnv}
}{%
\Vskip{-3em}\begin{center}
\begin{MPSquareEnv}
\MPSquare{$a$}{$b$}{$c$}{$d$}{$e$}{$f$}{$g$}{$h$}{$k$}
\end{MPSquareEnv}
\end{center}
}
    
\end{frame}

\section*{Variations}

\begin{frame}{Variation 1}{All products are the same except one}
\Vskip{-5em}\TwoUnequalColumns{0.53\textwidth}{0.47\textwidth}{%
\begin{MPSquareEnv}
\begin{itemize}[<+->]
    \item In the version we consider, we require the product of each row's entries to be \PP{} and the product of each column's entries to be \MM{}.
    \item In another version, the product of each row's and each column's entries is \PP{}, \emph{except} the product of the third column's entries is \MM{}.
    \item A solution to the first form can be reduced from a solution to the second form by always negating the values as shown.
    \item The proof of no static solution is the same.
\end{itemize}
\end{MPSquareEnv}
}{%
\Vskip{-1em}\begin{center}
\begin{MPSquareEnv}
\MPSquare{ }{ }{ }{ }{ }{ }{\visible<3->{\alert{$-$}}}{\visible<3->{\alert{$-$}}}{ }
\end{MPSquareEnv}
\end{center}
\visible<4->{%
\begin{MPSquareEnv}%
This causes columns~1 and~2 to have product~\MM{}.  The third row still has a positive product because the two negations cancel.\end{MPSquareEnv}
}
}
\end{frame}

\begin{frame}{Variation 2}{Using sums instead of products}
\Vskip{-3em}\TwoUnequalColumns{0.6\textwidth}{0.4\textwidth}{%
\begin{MPSquareEnv}
\begin{itemize}
    \item<1-> Here is the \href{https://arxiv.org/pdf/1802.10119}{original formulation}, although it was presented using colors instead of bits.
    \item<2-> In this variation, \ColorOne{Alice}'s rows must have even parity, and \ColorTwo{Bob}'s columns must have odd parity.
    \item<3-> The \PP{} and \MM{} of the original version are mapped to $0$ and $1$, respectively.
    \item<4-> Of course there is still no solution classically for every square.
\end{itemize}
\end{MPSquareEnv}
}{%
\Vskip{-3em}\begin{center}
\alt<1>{%
\begin{MPSquareEnv}\MPSquare{\PP{}}{\PP{}}{\PP{}}{\PP{}}{\MM{}}{\MM{}}{\MM{}}{\PP{}}{\alert{?}}\end{MPSquareEnv}}{%
\begin{MPSquareEnv}
\MPSquare{$0$}{$0$}{$0$}{$0$}{$1$}{$1$}{$1$}{$0$}{\alert{?}}
\end{MPSquareEnv}}
\end{center}
}

\end{frame}

\section*{Review}

\begin{frame}{Review:  measurement of a Bell state}{Upon measurement, the entanglement is broken}

\begin{itemize}[<+->]
    \item Consider Bell State \(\frac{\ket{\ColorOne{0}\ColorTwo{0}}+\ket{\ColorOne{1}\ColorTwo{1}}}{\sqrt{2}}\)
    where \ColorOne{Alice} has one qubit and \ColorTwo{Bob} has the other.
    \item If measured in the usual (computational, \PauliZ{}) basis, the only outcomes are~\ColorOne{\QZero}\ColorTwo{\QZero} or~\ColorOne{\QOne}\ColorTwo{\QOne}.  We assume WLOG that \ColorOne{Alice} measures first.
  
    \item If \ColorOne{Alice} measures \ColorOne{her qubit} in any other basis, then with equal probability she will obtain one of the two eigenstates of that basis.
    \item \ColorTwo{Bob's} qubit is then in exactly the same state as \ColorOne{Alice's} after she measures.
    \item The resulting state is no longer entangled.
    \item What \ColorTwo{Bob} observes upon measurement depends on the basis in which he measures \ColorTwo{his qubit}.
    \begin{itemize}
        \item If it's the same basis as \ColorOne{Alice}, then \ColorTwo{Bob} certainly obtains the same state as \ColorOne{Alice}.
        \item Generally, his result's agreement with \ColorOne{Alice's} state depends on $\cos^{2}\theta$, where $\theta$ is the angle between \ColorTwo{Bob's} basis and \ColorOne{Alice's}.
    \end{itemize}
\end{itemize}
    
\end{frame}

\begin{frame}{Review: saying this another way}{Alice's measurement determines the state of Bob's qubit}

\begin{itemize}[<+->]
    \item We begin with \[\frac{\ket{\ColorOne{0}\ColorTwo{0}}+\ket{\ColorOne{1}\ColorTwo{1}}}{\sqrt{2}}\]
    \item \ColorOne{Alice} measures \ColorOne{her qubit} in some basis, obtaining state $\ket{\psi}$.  She was equally likely to obtain $\ket{\psi'}$ where $\braket{\psi}{\psi'}=\braket{\psi'}{\psi}=0$.
    \item \textbf{The qubits are no longer entangled.}  \ColorOne{Alice's} subsequent actions on her qubit have no effect on \ColorTwo{Bob's}.
    \item \ColorTwo{Bob's qubit} is in state $\ket{\psi}$.  Any actions \ColorTwo{Bob} takes on his qubit have no effect on \ColorOne{Alice's}.
    \item If \ColorTwo{Bob} measures in some basis, the usual rules apply concerning the outcome of that measurement, which are based on the relationship of \ColorTwo{Bob's basis} to $\ket{\psi}$.
\end{itemize}
    
\end{frame}

\begin{frame}{Review: the eigenvalue associated with measuring two qubits}{The result is the product of the qubits' eigenvalues}
\begin{MPScene}
\begin{itemize}
    \item<1-> Alice has qubits \Aone{} and \Atwo{}.
    \item<1-> Bob has qubits \Bone{} and \Btwo{}.
    \item<2-> \ColorOne{Alice} will measure \Aone{} and \Atwo{} in bases dictated by her assigned row.
    \item<2-> \ColorTwo{Bob} will measure \Bone{} and \Btwo{} in bases dictated by his assigned column.
    \item<3-> Recall that the eigenvalue, $\pm 1$, for a multiqubit measurement is the \emph{product} of the measurements' eigenvalues, each also $\pm 1$.
    \item<4-> Thus, if $M_1$ and $M_2$ are the results of measuring \Aone{} and \Atwo{}, respectively, then the value of the joint measurement is simply $M_{1}\times M_{2}$.
    \item<5-> For almost all cases, that is the value reported by \ColorOne{Alice}. However, two cases require her to \emph{complement} the joint measurement, reporting the opposite of what she sees.
\end{itemize}
\end{MPScene}

\end{frame}

\begin{frame}{Some discussion of simultaneity}{This has probably caused some discomfort}

\begin{itemize}[<+->]
    \item Throughout we have assumed \ColorOne{Alice} measures before \ColorTwo{Bob}.
    \item The discussion is exactly the same if \ColorTwo{Bob} measures before \ColorOne{Alice}:  the players simply exchange roles in the discussion.
    \item Let's consider what might happen if they measure simultaneously.  There are two possibilities:
    \begin{itemize}
        \item They measure in the same basis.  They will see the same state as a result, and we can't tell they measured simultaneously, or one before the other, since the outcome is the same.
        \item They measure in different bases.  They may see the same outcome, or not, but since all four combinations are still possible, none of the outcomes can indicate that the measurement was simultaneous.
    \end{itemize}
    \item Practically speaking, there is no reason to consider simultaneous measurement.
\end{itemize}
    
\end{frame}



\section*{Approaches}

\begin{frame}{Square-by-square approach}{Each player performs 3 measurements as prescribed by the solution}
\begin{MPScene}

\TwoColumns{%
\Vskip{-3em}\begin{itemize}
\item The solution is shown the right.  
\item Rather than providing a direct answer, each square indicates the basis \TensProd{M_{1}}{M_{2}} in which qubits $q_{1}$ and $q_{2}$ should be measured.
\item \ColorOne{Alice} uses the squares in her row, performing the specified measurements on her qubits \Aone{} and~\Atwo.
\item \ColorTwo{Bob} uses the squares in his column, performing the specified measurements on his qubits \Bone{} and~\Btwo.
\end{itemize}
}{%
\begin{MPSquareEnv}
    \MPSoln{}
\end{MPSquareEnv}
}
    
\end{MPScene}
\end{frame}

\begin{frame}{Other approaches}{Two other ways to understand or prove a quantum solution to this puzzle}
\begin{MPScene}

\TwoUnequalColumns{0.65\textwidth}{0.35\textwidth}{%
\Vskip{-3em}\begin{itemize}
\item \textbf{Proof:} We can show that the prescribed measurements cause \ColorOne{Alice} to compute $+1$ as the product across any row, regardless of the state of her qubits \Aone{} and \Atwo.  Similarly, \ColorTwo{Bob} obtains $-1$ as the product down any column using \Bone{} and \Btwo.

This approach is non-constructive and does not yield actual answers for any square.
\item \textbf{Measure once:} Based on her assigned row, \ColorOne{\Alice} can perform a \emph{single measurement} on \Aone{} and \Atwo{}, collapsing each from its entangled partners \Bone{} and \Btwo{}.  The result of that measurement is an eigenstate of each of the squares' measurement operators.
\end{itemize}
}{%
\adjustbox{max width=
\textwidth}{%
\begin{MPSquareEnv}
    \MPSoln{}
\end{MPSquareEnv}}
}
    
\end{MPScene}
\end{frame}


\section*{Examples}

\begin{frame}{Summary of the measure once approach}{From entanglement to measurement, the steps performed in the upcoming examples}
\begin{MPScene}

\Vskip{-3.5em}\begin{itemize}
    \item The entangled pair pair $(\Aone,\Bone)$ is generated  
\(\ket{\Aone{}\Bone{}}=\TwoSup{00}{11}\)
    \item The entangled pair pair $(\Atwo,\Btwo)$ is generated  
\(\ket{\Atwo{}\Btwo{}}=\TwoSup{00}{11}\)
\item Alice takes \Aone{} and \Atwo{}. Bob takes \Bone{} and \Btwo{}. They separate to play the game.
\item Alice measures \Aone{} in a basis determined by her assigned row (we study later how to perform that measurement). 
\item Bob's \Bone{} collapses into the same state as Alice's \Aone{} after her measurement.
 \item Bob measures \Btwo{} in a basis determined by his assigned column.
 \item Alice's \Atwo{} is in the same state as Bob's \Btwo{} after his measurement.
\item When the measurements are complete, we obtain
\[\QState{a} =\TensProd{\Aone}{\Atwo}=\TensProd{\Bone}{\Btwo}=\QState{b}\]
\item These resulting states are eigenstates of the measurement operators in Alice's row and in Bob's column.
\end{itemize}
    
\end{MPScene}
\end{frame}


\begin{frame}{Measurement examples}{First Alice, then Bob}

\alert{a mess, fix. Examples don't have Alice measuring both before Bob.}

\begin{itemize}
    \item Alice and Bob have the solution grid, which tells them the measurements they must perform to provide an answer for a given square.
    \item Each performs a single (pre)measurement of the two qubits they possess, in a basis determined by their assigned row (for Alice) and column (for Bob).
    \item Each qubit and its entangled partner collapses into a basis state of the basis of measurement.  For example:
    \begin{itemize}
        \item In the \PauliZ{} basis, both collapse to \QZero{} or \QOne{}.
        \item In the \PauliX{} basis, both collapse to \ket{+} or \ket{-}.
    \end{itemize}
    \item Each qubit is then no longer entangled with its counterpart.
\end{itemize}
\end{frame}

\begin{frame}{Scenario with the square: Row 1 and Column 1}{Alice's row number tells her what basis to use for measurement.\\Independently, Bob's column number tells him what basis to use.}
\begin{MPScene}
\TwoUnequalColumns{0.7\textwidth}{0.3\textwidth}{%
\Vskip{-4em}\begin{center}
\adjustbox{valign=t,scale=0.8}{%
\begin{quantikz}
\lstick{\ColorOne{\QZero}}\qw &  \gate{\Hadamard} & \ctrl{1} & \qw\rstick{\AoneColor{\Aone\visible<4->{=\QOne}}} \\
\lstick{\ColorTwo{\QZero}}\qw & \qw & \targ{} & \qw \rstick{\BoneColor{\Bone\visible<4->{=\QOne}}}
\end{quantikz}}%
\hbox to 3ex{\hss}%
\adjustbox{valign=t,scale=0.8}{%
\begin{quantikz}
\lstick{\ColorOne{\QZero}}\qw &  \gate{\Hadamard} & \ctrl{1} & \qw\rstick{\AtwoColor{\Atwo\visible<5->{=\ket{+}}}} \\
\lstick{\ColorTwo{\QZero}}\qw & \qw & \targ{} & \qw\rstick{\BtwoColor{\Btwo\visible<5->{=\ket{+}}}}
\end{quantikz}}\end{center}%
\visible<1->{
\Vskip{-2em}\begin{ProtocolDialog}{0.25\textwidth}{0.375\textwidth}{0.375\textwidth}
\visible<2->{\All{{\small\ColorOne{Row 1} \visible<3->{\ColorTwo{Col 1}}}}{Measure in \TensProd{\AoneColor{\PauliZ}}{\AtwoColor{\PauliZ}}}{\visible<3->{Measure in \TensProd{\BoneColor{\PauliZ}}{\BtwoColor{\PauliX}}}}}
\visible<4->{\AliceBob{Measure \AoneColor{\Aone{}=\QOne}}{\alert{Collapse} \BoneColor{\Bone{}=\QOne}}}
\visible<5->{\AliceBob{\alert{Collapse} \AtwoColor{\Atwo{}=\ket{+}}}{Measure \BtwoColor{\Btwo{}=\ket{+}}}}
\visible<7->{\Alice{\ReportCommon{\AoneColor{-1}\times \IColor{1}}}}
\visible<9->{\Alice{\Report{\IColor{1}\times \AtwoColor{\Ambig{1}}}}}
\visible<11->{\Alice{\Report{\AoneColor{-1}\times \AtwoColor{\Ambig{1}}}}}
\visible<13->{\Bob{\ReportCommon{\BoneColor{-1}\times\IColor{1}}}}
\visible<15->{\Bob{\Report{\IColor{1}\times\BtwoColor{1}}}}
\visible<17->{\Bob{\Report{\alert{-}(\BoneColor{-1}\times\BtwoColor{1})}}}
\end{ProtocolDialog}}
}{%
\Vskip{-3em}\begin{itemize}\small
    \item \Alice{} has \Aone{} and \Atwo.
    \item \MakeSameWidth[l]{Alice}{\Bob{}} has \Bone{} and \Btwo.
    \item $\QZero{} = +1$
    \item $\QOne{} = -1$
    \item \Ovalbox{$n$} random result~$n$
    \item \ReportCommon{\mbox{agreement}}
\end{itemize}
\Vskip{-3.5em}\begin{center}\adjustbox{scale=0.75}{%
\hskip -4em\begin{MPSquareEnv}
    \def\TpLf####1{\only<12>{\ColorTwo{\TensProd{\BoneColor{\PauliZ}}{\BtwoColor{\Identity}}}}\only<6>{\ColorOne{\TensProd{\AoneColor{\PauliZ}}{\AtwoColor{\Identity}}}}\only<2>{\ColorOne{####1}}\only<3>{\ColorTwo{####1}}\only<1,4-5>{####1}\only<7-11>{\ColorOne{\Answer{-1}}}\only<13->{\ColorTwo{\Answer{-1}}}}
    \def\TpCt####1{\only<8>{\ColorOne{\TensProd{\AoneColor{\Identity}}{\AtwoColor{\PauliZ}}}}\only<2>{\ColorOne{####1}}\only<1,3-7,12->{####1}\only<9-11>{\ColorOne{\Answer{+1}}}}
    \def\TpRt####1{\only<10>{\ColorOne{\TensProd{\AoneColor{\PauliZ}}{\AtwoColor{\PauliZ}}}}\only<2>{\ColorOne{####1}}\only<1,3-9,12->{####1}\only<11>{\ColorOne{\Answer{-1}}}}
    \def\MdLf####1{\only<14>{\ColorTwo{\TensProd{\BoneColor{\Identity}}{\BtwoColor{\PauliX}}}}\only<3>{\ColorTwo{####1}}\only<1-2,4-13>{####1}\only<15->{\ColorTwo{\Answer{+1}}}}
    \def\BtLf####1{\only<16>{\alert{\Not{\ColorTwo{\TensProd{\BoneColor{\PauliZ}}{\BtwoColor{\PauliX}}}}}}\only<3>{\ColorTwo{####1}}\only<1-2,4-15>{####1}\only<17->{\ColorTwo{\Answer{+1}}}}
    \MPSoln{}
\end{MPSquareEnv}}
\end{center}
}
\end{MPScene}
\end{frame}



\begin{frame}{Scenario with the square: Row 1 and Column 2}{Alice's row number tells her what basis to use for measurement.\\Independently, Bob's column number tells him what basis to use.}
\begin{MPScene}
\TwoUnequalColumns{0.7\textwidth}{0.3\textwidth}{%
\Vskip{-4em}\begin{center}
\adjustbox{valign=t,scale=0.8}{%
\begin{quantikz}
\lstick{\ColorOne{\QZero}}\qw &  \gate{\Hadamard} & \ctrl{1} & \qw\rstick{\AoneColor{\Aone\visible<4->{=\QOne}}} \\
\lstick{\ColorTwo{\QZero}}\qw & \qw & \targ{} & \qw \rstick{\BoneColor{\Bone\visible<4->{=\QOne}}}
\end{quantikz}}%
\hbox to 3ex{\hss}%
\adjustbox{valign=t,scale=0.8}{%
\begin{quantikz}
\lstick{\ColorOne{\QZero}}\qw &  \gate{\Hadamard} & \ctrl{1} & \qw\rstick{\AtwoColor{\Atwo\visible<5->{=\QZero}}} \\
\lstick{\ColorTwo{\QZero}}\qw & \qw & \targ{} & \qw\rstick{\BtwoColor{\Btwo\visible<5->{=\QZero}}}
\end{quantikz}}\end{center}%
\visible<1->{
\Vskip{-2em}\begin{ProtocolDialog}{0.25\textwidth}{0.375\textwidth}{0.375\textwidth}
\visible<2->{\All{{\small\ColorOne{Row 1} \visible<3->{\ColorTwo{Col 2}}}}{Measure in \TensProd{\AoneColor{\PauliZ}}{\AtwoColor{\PauliZ}}}{\visible<3->{Measure in \TensProd{\BoneColor{\PauliX}}{\BtwoColor{\PauliZ}}}}}
\visible<4->{\AliceBob{Measure \AoneColor{\Aone{}=\QOne}}{\alert{Collapse} \BoneColor{\Bone{}=\QOne}}}
\visible<5->{\AliceBob{\alert{Collapse} \AtwoColor{\Atwo{}=\QZero}}{Measure \BtwoColor{\Btwo{}=\QZero}}}
\visible<7->{\Alice{\Report{\AoneColor{-1}\times \IColor{1}}}}
\visible<9->{\Alice{\ReportCommon{\IColor{1}\times \AtwoColor{1}}}}
\visible<11->{\Alice{\Report{\AoneColor{-1}\times \AtwoColor{1}}}}
\visible<13->{\Bob{\ReportCommon{\IColor{1}\times\BtwoColor{1}}}}
\visible<15->{\Bob{\Report{\BoneColor{\Ambig{-1}}\times\IColor{1}}}}
\visible<17->{\Bob{\Report{\alert{\Not{\BoneColor{\Ambig{-1}}\ColorBlack{\times}\BtwoColor{1}}}}}}
\end{ProtocolDialog}}
}{%
\Vskip{-3em}\begin{itemize}\small
    \item \Alice{} has \Aone{} and \Atwo.
    \item \MakeSameWidth[l]{Alice}{\Bob{}} has \Bone{} and \Btwo.
    \item $\QZero{} = +1$
    \item $\QOne{} = -1$
    \item \Ovalbox{$n$} random result~$n$
    \item \ReportCommon{\mbox{agreement}}
\end{itemize}
\Vskip{-3.5em}\begin{center}\adjustbox{scale=0.75}{%
\hskip -4em\begin{MPSquareEnv}
    \def\TpCt####1{\only<12>{\ColorTwo{\TensProd{\BoneColor{\Identity}}{\BtwoColor{\PauliZ}}}}\only<8>{\ColorOne{\TensProd{\AoneColor{\Identity}}{\AtwoColor{\PauliZ}}}}\only<2>{\ColorOne{####1}}\only<3>{\ColorTwo{####1}}\only<1,4-7>{####1}\only<9-11>{\ColorOne{\Answer{+1}}}\only<13->{\ColorTwo{\Answer{+1}}}}
    \def\TpLf####1{\only<6>{\ColorOne{\TensProd{\AoneColor{\PauliZ}}{\AtwoColor{\Identity}}}}\only<2>{\ColorOne{####1}}\only<1,3-5,12->{####1}\only<7-11>{\ColorOne{\Answer{-1}}}}
    \def\TpRt####1{\only<10>{\ColorOne{\TensProd{\AoneColor{\PauliZ}}{\AtwoColor{\PauliZ}}}}\only<2>{\ColorOne{####1}}\only<1,3-9,12->{####1}\only<11>{\ColorOne{\Answer{-1}}}}
    \def\MdCt####1{\only<14>{\ColorTwo{\TensProd{\BoneColor{\PauliX}}{\BtwoColor{\Identity}}}}\only<3>{\ColorTwo{####1}}\only<1-2,4-13>{####1}\only<15->{\ColorTwo{\Answer{-1}}}}
    \def\BtCt####1{\only<16>{\alert{\Not{\ColorTwo{\TensProd{\BoneColor{\PauliX}}{\BtwoColor{\PauliZ}}}}}}\only<3>{\ColorTwo{####1}}\only<1-2,4-15>{####1}\only<17->{\ColorTwo{\Answer{+1}}}}
    \MPSoln{}
\end{MPSquareEnv}}
\end{center}
}
\end{MPScene}
\end{frame}

\section*{Successive measurements}

{
\def\M#1#2{\mbox{#1{\ensuremath{\mathcal{M}_{#2}}}}}
\def\Mone{\M{\ColorThree}{1}}
\def\Mtwo{\M{\ColorFour}{2}}
\def\Mthree{\M{\ColorFive}{3}}
\begin{frame}{Successive measurements}{These are reliable if there is a common eigenbasis}
\Vskip{-4.5em}\TwoUnequalColumns{0.6\textwidth}{0.4\textwidth}{%
\only<1-8>{%
\begin{itemize}
    \item<1-> The boxes represent measurement operators applied to the two-qubit circuit.
    \item<2-> Recall that the operators are implemented by 
    \Vskip{-2em}\begin{enumerate}
        \item transformation into the \PauliZ{} basis
        \item measurement in the \PauliZ{} basis
        \item transformation out of the \PauliZ{} basis
    \end{enumerate}
    but to avoid clutter we show this using the measurement operators.
    \item<3-> After \Mone, the quantum system's state must be an eigenstate of \Mone.
    \item<4-> If \Mtwo{} and \Mthree{} share an eigenbasis with \Mone, then the outcome of their measurements is determined solely by \Mone.
\end{itemize}}%
\only<9-14>{%
\begin{itemize}
    \item<9-> Suppose we change the sequence of measurements, so that \Mtwo{} is first.
    \item<10-> While \Mtwo's results could be unpredictable, the resulting eigenstate \QState{} \emph{completely determines} the outcomes of \Mone{} and \Mthree.
    \item<11-> If we prepare eigenstate~\QState{} by measuring in the common eigenbasis of the operators, then \Mtwo's outcome is also determined.
    \item<12-> Each outcome is $\pm 1$: the eigenvalue associated with \QState{} for each operator.
    \item<13-> Let the cummulative result of the three operators be the \emph{product} of their measured eigenvalues.
\end{itemize}
}%
\only<15->{%
\begin{itemize}
    \item<15-> We regard the puzzle's solution in two ways:
    \begin{itemize}
        \item<16-> A single measurement of the two qubits is performed to obtain eigenstate \alert<16>{\QState{}}, which determines the outcome of \Mone, \Mtwo, and \Mthree.  Those eigenvalues' product will yield the desired result.
        \item<17-> Three successive measurements are made, but the \alert<17>{first outcome} determines the other two outcomes.  The product of the three eigenvalues will also be as desired.
    \end{itemize}
    \item<18-> Linear algebra teaches that if each pair of operators in \Set{\Mone, \Mtwo, \Mthree} \emph{commutes}, then there is a common eigenbasis for the three operators.
\end{itemize}
}
}{%
\begin{center}
\adjustbox{scale=0.75,valign=t}{%
\begin{quantikz}[row sep=-12pt] \lstick[wires=2]{\mbox{\visible<11-14,16>{\alert<16>{\QState{}}}}}\qw & \gate[wires=2]{\alt<9-14>{\Mtwo}{\Mone}}\slice{\mbox{\visible<1-10,17->{\alert<17>{\QState{}}}}} & \qw & \gate[wires=2]{\alt<9-14>{\Mone}{\Mtwo}} & \qw & \gate[wires=2]{\Mthree} & \qw \\
\qw & \qw & \qw & \qw & \qw & \qw & \qw
\end{quantikz}}\end{center}%
\only<1-8>{%
\begin{itemize}
    \item<5-> Suppose the outcome of \Mone{} is \QState{}, an eigenstate of \Mtwo{}.
    \item<6-> Then $\Mtwo\QState{}=\pm 1\QState{}$, an eigenstate of \Mthree.
    \item<7-> Then $\Mthree\QState{}=\pm 1\QState{}$.
\end{itemize}
\SmallSkip{}\visible<8->{%
The results of \Mtwo{} and \Mthree{} are determined by \QState{}, the result of~\Mone.}
}%
\only<14>{%
\begin{MPSquareEnv}\SmallSkip{}We can choose operators such that for any eigenstate~\QState{} common to the three operators, we obtain products as follows: 
    \begin{itemize}
      \item \ColorOne{\PP{}} for \ColorOne{Alice's rows}
      \item \ColorTwo{\MM{}} for \ColorTwo{Bob's columns}
    \end{itemize}\end{MPSquareEnv}
}%
\only<18->{%
\SmallSkip{}A pair of operators \Set{A,B} commutes if
\[ \left(A\times B\right) - \left(B\times A\right) = \ZeroMatrix \]
where \ZeroMatrix{} is the all-zero matrix.}%
}
    
\end{frame}

\section*{Commuting operators}

\def\B#1{\hbox to 1.2em{\hss\ensuremath{#1}}}
\begin{frame}{Example of three commuting operators}{Column 2 of the square's solution}

\Vskip{-5em}\TwoUnequalColumns{0.455\textwidth}{0.545\textwidth}{%
\only<1-10>{%
\begin{itemize}
    \item<1-> We need to find an eigenbasis common to all three operators.
    \item<2-> \MATLAB{} provides this common eigenbasis for \Mone{} and \Mtwo{} \visible<3->{and their eigenvalues.}
    \item<4-> We next develop their \TensProd{\PauliX}{\PauliZ} product states  normalization.
\end{itemize}
\visible<2->{%
\Vskip{-3em}\begin{center}\small
    \begin{tabular}{cccc}
    \alert<5>{\QState{1}} & \alert<6>{\QState{2}} & \alert<7>{\QState{3}} & \alert<8>{\QState{4}} \\
     \visible<3->{$1$ & $-1$ & $-1$ & $1$ \\}
     \alert<5>{\DQB{-1}{0}{-1}{0}}
           & \alert<7>{\DQB{0}{-1}{0}{-1}}
           & \alert<6>{\DQB{-1}{0}{1}{0}}
           & \alert<8>{\DQB{0}{-1}{0}{1}} \\[2em]
        \visible<5->{   \ket{\ColorOne{+}\ColorTwo{0}}} & \visible<6->{\ket{\ColorOne{+}\ColorTwo{1}}}& \visible<7->{\ket{\ColorOne{-}\ColorTwo{0}}} &\visible<8->{\ket{\ColorOne{-}\ColorTwo{1}}}
    \end{tabular}
\end{center}}}%
\only<11->{%
\begin{center}
\adjustbox{scale=0.75,valign=t}{%
\begin{quantikz} 
\qw & \gate[wires=2]{\mbox{$\Conj{T}$}} & \qw & \meter{0\,/\,1} & \qw & \gate[wires=2]{\mbox{$T$}} & \qw \\
\qw & \qw & \qw & \meter{0\,/\,1} & \qw & \qw & \qw
\end{quantikz}}\end{center}%
\only<11-12>{%
\begin{itemize}
    \item<11-> The circuit above uses a single measurement to capture an observation in the \TensProd{\PauliX}{\PauliZ} basis.
    \item<12-> Based on the order of eigenstates in $T$, we decode the result as follows:
    \begin{center}
        \begin{tabular}{c@{$\mapsto$}c|c@{$\mapsto$}c}
        \ket{00} & \ket{+0} & \ket{01} & \ket{+1} \\
        \ket{10} & \ket{-0} & \ket{11}& \ket{-1}
         \end{tabular}
    \end{center}
\end{itemize}}%
\only<13->{%
\begin{center}
\adjustbox{scale=0.75,valign=t}{%
\begin{quantikz} 
\qw & \gate{\Hadamard} & \qw & \meter{0\,/\,1} & \qw & \gate{\Hadamard} & \qw \\
\qw & \qw & \qw & \meter{0\,/\,1} & \qw & \qw & \qw
\end{quantikz}}\end{center}%
$T$ and \Conj{T} can now be implemented separately on each qubit, as shown above, using an \Hadamard{} and \Identity{} (nothing) gate.
}
}
}{%
\only<1-4>{%
\begin{align*}
    \Mone =& \ColorThree{\TensProd{\Identity}{\PauliZ}} =& \ColorThree{\begin{pmatrix*}[r]
     \B{1}  &   \B{0}  &   \B{0}   &  \B{0} \\
     \B{0}  &  \B{-1}  &   \B{0}   &  \B{0} \\
     \B{0}  &   \B{0}  &   \B{1}   &  \B{0} \\
     \B{0}  &   \B{0}  &   \B{0}   & \B{-1}
    \end{pmatrix*}} \\
    \Mtwo =& \ColorFour{\TensProd{\PauliX}{\Identity}} =& \ColorFour{\begin{pmatrix*}[r]
     \B{0}   &  \B{0}  &   \B{1}   &  \B{0} \\
     \B{0}   &  \B{0}  &   \B{0}   &  \B{1} \\
     \B{1}   &  \B{0}  &   \B{0}   &  \B{0} \\
     \B{0}   &  \B{1}  &   \B{0}   &  \B{0}
    \end{pmatrix*}} \\
    \Mthree =& \ColorFive{\TensProd{\PauliX}{\PauliZ}} =& \ColorFive{\begin{pmatrix*}[r]
     \B{0} &     \B{0} &     \B{1} &     \B{0} \\
     \B{0} &     \B{0} &     \B{0} &    \B{-1} \\
     \B{1} &     \B{0} &     \B{0} &     \B{0} \\
     \B{0} &    \B{-1} &     \B{0} &     \B{0}
    \end{pmatrix*}}
\end{align*}}
\only<5-6>{%
\begin{align*}
\alert<5>{\DQB{-1}{0}{-1}{0}} &\equiv \RootTwo{}\DQB{1}{0}{1}{0} &=\TensProd{\ColorOne{\PPlus}}{\ColorTwo{\PZero}} \\[2em]
\visible<6->{\alert<6>{\DQB{-1}{0}{1}{0}} &\equiv \RootTwo{}\DQB{1}{0}{-1}{0} &= \TensProd{\ColorOne{\PMinus}}{\ColorTwo{\PZero}}}
\end{align*}
}%
\only<7-8>{%
\begin{align*}
\alert<7>{\DQB{0}{-1}{0}{-1}} &\equiv \RootTwo{}\DQB{0}{1}{0}{1} &=\TensProd{\ColorOne{\PPlus}}{\ColorTwo{\POne}} \\[2em]
\visible<8->{\alert<8>{\DQB{0}{-1}{0}{1}} &\equiv \RootTwo{}\DQB{0}{1}{0}{-1} &= \TensProd{\ColorOne{\PMinus}}{\ColorTwo{\POne}}}
\end{align*}
}%
\only<9->{%
\SmallSkip{}\only<9>{

This serves as an eigenbasis also for \Mthree, so we can now construct our matrices~$T$ and~\Conj{T}.}
\[
T = \RootTwo{} \alt<9>{\begin{pmatrix*}
\DQB{1}{0}{1}{0} & 
\DQB{0}{1}{0}{1} &
\DQB{1}{0}{-1}{0} &
\DQB{0}{1}{0}{-1}
\end{pmatrix*}}{%
\begin{pmatrix*}[r]
1 & 0 & 1 & 0 \\
0 & 1 & 0 & 1 \\
1 & 0 &-1 & 0 \\
0 & 1 & 0 &-1
\end{pmatrix*}
}
\]
\only<10->{%
\SmallSkip{}\only<10>{
$T$ is its own conjugate transpose, so:}
\[
\Conj{T} = T
\]}
\only<11->{%
\Vskip{-3em}\begin{itemize}
   \item<11-> Our $T$ matrix is factorable as \TensProd{\Hadamard}{\Identity}.
   \item<12-> This more clearly maps $\TensProd{\PauliZ}{\PauliZ}\leftrightarrow\TensProd{\PauliX}{\PauliZ}$ basis, sending the top qubit into and out of the \PauliX{} basis and leaving the bottom qubit undisturbed in the \PauliZ{} basis.
\end{itemize}
}
}
}
    
\end{frame}
}

\begin{frame}{Where are we?}{And what comes next?}

\begin{itemize}
    \item We have seen the Mermin--Peres puzzle.
    \item Classically we cannot hope to win always.
    \item \Alice{} and \Bob{} cannot know the \ColorTwo{column} or \ColorOne{row} assigned to the other player.
    \item However, due to entanglement and measurement in a predetermined basis, they can always win the game.
    \item We next examine proofs of their ability to win every game.
\end{itemize}
    
\end{frame}

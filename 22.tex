\SetTitle{22}{The phase kickback trick}{An unexpected but useful phenomenon}{22}

\begin{frame}{Overview}{What do we study here?}

\end{frame}

\begin{frame}{Recall our oracle}{With its ancillary input $y$}

\TwoUnequalColumns{0.37\textwidth}{0.63\textwidth}{%
\begin{Oracle}[scale=0.75]{$U_f$}{\alert<1>{$x$}}{\alert<2,5>{$y$}}{\alert<4,5>{$x$}}{\alert<3>{\Xor{y}{f(x)}}}
\end{Oracle}
}{%
\begin{itemize}[<+->]
    \item The input $x$ is the uniform superposition of all values.
    \item The input $y$ is \ket{-}.
    \item The bottom qubit has a constant value, regardless of $f(x)$.
    \item However, the top qubit is a superpositon of terms, each term with a sign related to the function $f$ evaluated on that term.
    \item This is \emph{phase kickback}:  The bottom qubit's input, when \ket{-}, kicks phase changes up the top qubit's output.
\end{itemize}
}

\end{frame}

{
\def\X{\ColorOne{\ensuremath{x}}}\def\Y{\ColorTwo{\ensuremath{y}}}
\begin{frame}{Single qubit}{Here $x$ is not in a superposition but simply a basis state.}
\TwoColumns{%
\begin{Oracle}[scale=0.75]{$U_f$}{$x$}{$y$}{$x$}{\Xor{y}{f(x)}}
\end{Oracle}
}{%
\only<1-7>{%
Recall
    $U_{f}:  \ket{\X\,\Y}\mapsto \ket{\X\,\Xor{\Y}{f(\X)}}$}
\only<8->{%
\Vskip{-3em}\begin{align*}
    U_f(\ket{x\,-}) &= \TwoSupOp{\ket{\X\,f(\X)}}{\ket{\X\,\Not{f(\X)}}}{-}
\end{align*}
}%
}
\only<1-7>{%
\TwoColumns{%
\begin{align*}
   \visible<1->{ U_f(\ket{x-}) &= U_f(\TensProd{\ket{x}}{\ket{-}}) \\}
    \visible<2->{&= U_f(\TensProd{\ket{x}}{\QMinus}) \\}
   \visible<3->{ &= U_{f}(\TwoSupOp{\ket{x0}}{\ket{x1}}{-}) \\}
  \visible<4->{  &= \RootTwo{}\left(U_f(\ket{\X\,\ColorTwo{0}})-U_f(\ket{\X\,\ColorTwo{1}})\right)}
\end{align*}
}{%
\begin{align*}
    \visible<5->{&= \RootTwo{}\left(\ket{\X\,(\Xor{\ColorTwo{0}}{f(\X)})}-U_f(\ket{\X\,\ColorTwo{1}})\right) \\}
    \visible<6->{&= \RootTwo\left(\ket{\X\,f(\X)} - \ket{\X\,(\Xor{\ColorTwo{1}}{f(\X)})}\right) \\}
    \visible<7->{&= \TwoSupOp{\ket{\X\,f(\X)}}{\ket{\X\,\Not{f(\X)}}}{-}}
\end{align*}
}}
\only<8-17>{%
\BigSkip{}
\TwoColumns{%
\visible<8->{Case $f(x)=0$}
\begin{align*}
   \visible<9->{U_f(\ket{x\,-}) &= \TwoSupOp{\ket{x\,0}}{\ket{x\,1}}{-} \\}
    \visible<10->{&= \TensProd{\ket{x}}{\QMinus} \\}
    \visible<11->{&= \TensProd{\ket{x}}{\ket{-}} \\}
   \visible<12->{ & = \ket{x\,-}}
\end{align*}
}{%
\visible<13->{Case $f(x)=1$}
\begin{align*}
   \visible<14->{ U_f(\ket{x\,-}) &= \TwoSupOp{\ket{x\,1}}{\ket{x\,0}}{-} \\}
    \visible<15->{&= \TensProd{\ket{x}}{\TwoSupOp{\QOne}{\QZero}{-}} \\}
   \visible<16->{ &= \TensProd{\ket{x}}{\alert{-}\QMinus} \\}
   \visible<17->{ & = \alert{-}\ket{x\,-}}
\end{align*}
}
}%
\only<18->{%
\BigSkip{}
\TwoColumns{%
Case $f(x)=0$
\[ U_f(\ket{x\,-}) = \alt<19-20>{\alert{\fbox{+1}}}{}\ket{x\,-} \]
}{%
Case $f(x)=1$
\[ U_f(\ket{x\,-}) = \alt<19-20>{\alert{\fbox{-1}}}{-}\ket{x\,-} \]
}
\BigSkip{}
\visible<19->{\[ U_f(\ket{x\,-}) \only<19>{= \alert<19-20>{\NegF{x}}\ket{x\,-}}
= \TensProd{\alert<19-20>{\NegF{x}}\ket{x}}{\ket{-}}\]}
\begin{itemize}
    \item<20-> Phase kickback associates the function result as the \emph{sign} on the state \ket{x\,-}.
    \item<21-> That sign is \emph{not} a global phase, with bottom qubit result \QMinus{}.
    \item<22-> The sign imposes a phase change relative to the \QZero{} and \QOne{} terms.
\end{itemize}
}
    
\end{frame}
}

\begin{frame}{Single qubit}{In superposition.}
\TwoColumns{%
\begin{Oracle}[scale=0.75]{$U_f$}{$x$}{$y$}{$x$}{\Xor{y}{f(x)}}
\end{Oracle}
}{%
\[ U_f(\ket{x\,-})
= \TensProd{\NegF{x}\ket{x}}{\ket{-}}\]
}
\BigSkip{}
\only<1-3>{%
Linearity allows the above equation to apply to a superposition:
    \begin{align*}
     \visible<1->{   \ket{x} & ={\alpha_0}\ket{0}+\alpha_{1}\ket{1} \\}
     \visible<2->{   U_f(\ket{x}) &= \alpha_{0}U_f(\ket{0}) + \alpha_{1}U_f(\ket{1}) \\}
       \visible<3->{ &= \alpha_{0} \NegF{0}\ket{0}
        +  \alpha_{1} \NegF{1}\ket{1}}
    \end{align*}
}%
\only<4-8>{%
This applies directly to Deutsch's problem ($f(x)$ constant$\longrightarrow U_f(\ket{x\,-}) = \ket{+\,-})$:
    \begin{description}
      \item[$\Forall{x}{f(x)=0}$] \visible<4->{\begin{align*}U_f(\ket{x\,-}) &= \TensProd{\TwoSupOp{\alt<4>{\alert{\NegF{0}}}{}\QZero}{\alt<4>{\alert{\NegF{1}}}{}\QOne}{+}}{\ket{-}}\only<5->{=\ket{+\,-}}\end{align*}}
      \item[$\Forall{x}{f(x)=1}$] 
      \Vskip{-3em}\begin{align*}
   \visible<6->{   U_f(\ket{x\,-}) &= \TensProd{\TwoSupOp{\alt<6>{\alert{\NegF{0}}}{-}\QZero}{\alt<6>{\alert{\NegF{1}}}{-}\QOne{}}{+}}{\ket{-}}\\}
      \visible<8->{ & \equiv \TensProd{\QPlus{}}{\ket{-}}=\ket{+\,-}}
      \end{align*}
    \end{description}
}%
\only<9-13>{%
This applies directly to Deutsch's problem ($f(x)$ balanced$\longrightarrow U_f(\ket{x\,-}) = \ket{-\,-})$:
    \begin{description}
      \item[$f(0)=0,\ f(1)=1$] \visible<9->{\begin{align*}U_f(\ket{x\,-}) &= \TensProd{\TwoSupOp{\alt<9>{\alert{\NegF{0}}}{}\QZero}{\alt<9>{\alert{\NegF{1}}}{}\QOne}{\alt<9>{+}{-}}}{\ket{-}}\only<10->{=\ket{-\,-}}\end{align*}}
      \item[$f(0)=1,\ f(1)=0$] 
      \Vskip{-3em}\begin{align*}
   \visible<11->{   U_f(\ket{x\,-}) &= \TensProd{\TwoSupOp{\alt<11>{\alert{\NegF{0}}}{-}\QZero}{\alt<11>{\alert{\NegF{1}}}{}\QOne{}}{+}}{\ket{-}}\\}
      \visible<13->{ & \equiv \TensProd{\QMinus{}}{\ket{-}}=\ket{-\,-}}
      \end{align*}
    \end{description}
}
\end{frame}
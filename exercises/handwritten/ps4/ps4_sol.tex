\documentclass[12pt]{article}
\usepackage{amssymb,mathrsfs, amsmath,amsfonts}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{braket}
\graphicspath{ {./ps4-assets/}{./exercises/handwritten/ps4/ps4-assets/} }

\title{Problem Set 4 Solutions}
\author{CSE 468}
\date{\today}

\begin{document}

\maketitle

\begin{enumerate}[font=\bfseries]
    \item Math shown below.
    \[CZ(H \otimes I) = \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    1 & 0 & 1 & 0 \\
    0 & 1 & 0 & 1 \\
    1 & 0 & -1 & 0 \\
    0 & -1 & 0 & 1
    \end{pmatrix}
    \]
    No the state obtained is not entangled. Most easily verified by testing circuit with Qiskit. Analytic reasoning given below:
    \[H \otimes I = \frac{1}{\sqrt{2}}\begin{pmatrix}
    1 & 0 & 1 & 0 \\
    0 & 1 & 0 & 1 \\
    1 & 0 & -1 & 0 \\
    0 & 1 & 0 & -1
    \end{pmatrix}\]
    \[CZ(H \otimes I) = \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    1 & 0 & 1 & 0 \\
    0 & 1 & 0 & 1 \\
    1 & 0 & -1 & 0 \\
    0 & -1 & 0 & 1
    \end{pmatrix}
    \]
    \[\frac{1}{\sqrt{2}}
    \begin{pmatrix}
    1 & 0 & 1 & 0 \\
    0 & 1 & 0 & 1 \\
    1 & 0 & -1 & 0 \\
    0 & -1 & 0 & 1
    \end{pmatrix}
    \begin{pmatrix}
    1 \\ 0 \\ 0 \\ 0
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    1 \\ 0 \\ 1 \\ 0
    \end{pmatrix}
    \]
    \item No, the controlled Z gate cannot be written as the tensor product of two matrices. Note the controlled Z gate can be written as (from Qiskit):
    \[\begin{pmatrix}
    1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & -1
    \end{pmatrix}
    \]
    If the controlled Z gate could be written as the tensor product of two matrices we would have:
    \[
    \begin{pmatrix}
    a & b  \\
    c & d  \\
    \end{pmatrix}
    \otimes
    \begin{pmatrix}
    e & f  \\
    g & h  \\
    \end{pmatrix}
    =
    \begin{pmatrix}
    1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & -1
    \end{pmatrix}
    \]
    This gives:
    \[ae = 1, ah = 1, de = 1, dh = -1\]
    \[aedh = -1 \neq 1 = ahde\]
    \item \begin{enumerate}
        \item \[\includegraphics[scale=0.8]{teleport-action}\] 50\%. If Alice sends Bob a zero, he knows there's a 50\% chance that $\ket{xy} = \ket{00}$ and so he should do nothing and will obtain the correct state 50\% of the time. Similarly if Alice sends Bob a 1 he knows there's a 50\% chance that $\ket{xy} = \ket{11}$ and so he should do \mathbf{X} then \mathbf{Z} and will obtain the correct state 50\% of the time.
        \item If Bob knows the first qubit's value he knows if his state needs to experience a phase shift (a Z gate). If the value is 0 no phase shift is needed. If the value is 1 he knows he will need to apply a Z gate. He does not know if he needs to apply a X gate first though.
        \item If Bob knows the second qubit's value he knows if his amplitudes need to be flipped or not (a X gate). If the value is 0 no flip is needed. If the value is 1 he knows he will need to apply a X gate. He does not know if he needs to apply a Z gate though.
        \item He would want the second qubit. See (c).
    \end{enumerate}
    \item Bob must decide at random to apply ZX or not. He will obtain the correct state exactly half of the time.
    \item I believe Cytron has a good proof. For now I provide a proof for a slightly different question. Proof by contradiction: Let $\ket{\psi_e}$ be some entangled state. Suppose there exists some set of single qubit unitary operations that when applied to $\ket{\psi_e}$ results in some non-entangled state $\ket{\psi_n}$. Call this set of operations $A \otimes B$. We can then write
    \[\ket{\psi_n} = A(c_0\ket{0}+c_1\ket{1}) \otimes B(c_2\ket{0}+c_3\ket{1})\]
    since $\ket{\psi_n}$ is a non-entangled state. We could then apply $A^{-1} \otimes B^{-1}$ to $\ket{\psi_n}$ to obtain $\ket{\psi_e}$ as so
    \[(A^{-1} \otimes B^{-1})\ket{\psi_n} = A^{-1}A(c_0\ket{0}+c_1\ket{1}) \otimes B^{-1}B(c_2\ket{0}+c_3\ket{1})\]
    \[= (c_0\ket{0}+c_1\ket{1}) \otimes (c_2\ket{0}+c_3\ket{1}) = \ket{\psi_e}\]
    We observe above that $\ket{\psi_e}$ can be written as the tensor product of two states which contradicts our earlier assumption that $\ket{\psi_e}$ was an entangled state.
    \item I follow along a similar analysis to Lecture 10 below:
    \[\ket{\psi_A\psi_B} = 
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    0 \\ 1 \\ -1 \\ 0
    \end{pmatrix}
    ,
    \ket{\psi_x} = 
    \begin{pmatrix}
    \alpha_x \\ \beta_x
    \end{pmatrix}
    \]
    \[
    \ket{\psi_1} = \begin{pmatrix}
    \alpha_x \\ \beta_x
    \end{pmatrix}
    \otimes
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    0 \\ 1 \\ -1 \\ 0
    \end{pmatrix}
    =
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    0 \\ \alpha_x \\ -\alpha_x \\ 0 \\
    0 \\ \beta_x \\ -\beta_x \\ 0
    \end{pmatrix}
    \]
    \[
    \ket{\psi_2} = (CNOT \otimes I)\ket{\psi_1} = 
    \frac{1}{\sqrt{2}}
    \begin{pmatrix}
    0 \\ \alpha_x \\ -\alpha_x \\ 0 \\
    -\beta_x \\ 0 \\ 0 \\ \beta_x
    \end{pmatrix}
    \]
    8x8 matrices not included just to save space.
    \[
    \ket{\psi_3} = (H \otimes I \otimes I)\ket{\psi_2} = 
    \frac{1}{2}
    \begin{pmatrix}
    -\beta_x \\ \alpha_x \\ -\alpha_x \\ \beta_x \\
    \beta_x \\ \alpha_x \\ -\alpha_x \\ -\beta_x
    \end{pmatrix}
    \]
    \[\begin{tabular}{r|l}
\multicolumn{1}{c}{Alice measures} & \multicolumn{1}{c}{Bob's state} \\
  \ket{xy}=\ket{00} & -\beta_x\ket{0} + \alpha_x\ket{1}  \\
  \ket{xy}=\ket{01}  & -\alpha_x\ket{0} + \beta_x\ket{1} \\
  \ket{xy}=\ket{10} & \beta_x\ket{0} + \alpha_x\ket{1} \\
  \ket{xy}=\ket{11} & -\alpha_x\ket{0} - \beta_x\ket{1}
\end{tabular}\]
    \[\begin{tabular}{r|l}
\multicolumn{1}{c}{Alice measures} & \multicolumn{1}{c}{Bob's action} \\
  \ket{xy}=\ket{00} & X then Z  \\
  \ket{xy}=\ket{01}  & Z \\
  \ket{xy}=\ket{10} & X \\
  \ket{xy}=\ket{11} & Nothing
\end{tabular}\]

\item You have a 2/3 chance of measuring 0.
\end{enumerate}



\end{document}
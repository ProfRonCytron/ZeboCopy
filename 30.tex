\SetTitle{30}{Phase estimation}{What separates the superpositions in a state?}{30}

\begin{frame}{Overview}{What will we study here?}

\begin{itemize}[<+->]
    \item Phase has been an elusive aspect of quantum state.
    \item As we have studied, the probability of a measurement outcomes is related to the amplitude of the coefficient present the associated basis state.
    \item We use phase during a quantum computation to establish interference patterns of interest.
    \item While we cannot directly measure phase, we can estimate a constant phase shift between basis states in a superposition.
    \item The study of this material leads directly to quantum Fourier analysis, which in turn is the basis of Shor's famous algorithm.
\end{itemize}
    
\end{frame}

\section*{Phase shift}

\begin{frame}{A return to the complex circle}{The basics we need for phase estimation}
\TwoUnequalColumns{0.6\textwidth}{0.4\textwidth}{%
\adjustbox{valign=t, width=\textwidth}{\begin{TIKZP}
\UnitComplexCircle{}
\visible<1>{%
\TZPEast{}\TZPNorth{}\TZPSouth{}\TZPWest{}}
\visible<2>{%
  \draw[->,thick,\RCtwo] (1,0) arc (0:45:1) coordinate (z) ;
  \draw[thick,dotted,\RCtwo] (0,0) -- (z) ;
  \TZText{0.5,0}{$\theta$}{above}
    \ColorTwo{\TZText{z}{\ExpPhase{\theta}}{above right}}
}
\visible<3>{%
   \TZPoint{1,0}{$\ExpPhase{0}=+1$}{above right}}
\visible<4>{
      \TZPoint{0,1}{$\ExpPhase{\pi/2}=i$}{above right}
      \draw[->,thick,\RCtwo] (1,0) arc (0:90:1) coordinate (z) ;
    \draw[thick,dotted] (0,0) -- (z);}
\visible<5>{%
      \TZPoint{-1,0}{$\ExpPhase{\pi}=-1$}{above left}
      \draw[->,thick,\RCtwo] (1,0) arc (0:180:1) coordinate (z) ;
    \draw[thick,dotted] (0,0) -- (z);
    }
\visible<6>{%
      \TZPoint{0,-1}{$\ExpPhase{3\pi/2}=-i$}{below right}
      \draw[->,thick,\RCtwo] (1,0) arc (0:270:1) coordinate (z) ;
    \draw[thick,dotted] (0,0) -- (z);
    }
\visible<7-8>{%
      \TZPoint{1,0}{$\ExpPhase{2\pi}\visible<8>{=}$}{above right}
       \visible<8>{\TZPoint{1,0}{$\ExpPhase{0}=+1$}{below right}}
      \draw[->,thick,\RCtwo] (1,0) arc (0:359:1) coordinate (z) ;
    \draw[thick,dotted] (0,0) -- (z);
}
\end{TIKZP}}}{%
\begin{itemize}
    \item<1-> Unit points on each axis
    \item<2-> Traveling $\theta$ radians counterclockwise from $+1$
\end{itemize}
}
    
\end{frame}

\begin{frame}{Constant phase shift}{On the complex unit circle}
\TwoUnequalColumns{0.4\textwidth}{0.6\textwidth}{%
\adjustbox{valign=t, width=\textwidth}{\begin{TIKZP}
\UnitComplexCircle{}
\visible<3-8>{%
 \draw[->,thick,\RCone] (1,0) arc (0:40:1) coordinate (z2);
 \draw[thick,dotted] (0,0) -- (z2);
 \visible<4->{\draw[->,thick,\RCone] (1,0) arc (0:60:1) coordinate (z3);
 \draw[thick,dotted] (0,0) -- (z3);}
 \visible<5->{\draw[->,thick,\RCone] (1,0) arc (0:80:1) coordinate (z4);
 \draw[thick,dotted] (0,0) -- (z4);}
 \visible<6->{\draw[->,thick,\RCone] (1,0) arc (0:100:1) coordinate (z5);
 \draw[thick,dotted] (0,0) -- (z5);}
}
\visible<1-8>{%
  \draw[->,thick,\RCtwo] (1,0) arc (0:20:1) coordinate (z) ;
  \draw[thick,dotted,\RCtwo] (0,0) -- (z);
  \visible<1>{\TZText{0.55,0.15}{\mbox{\small $\theta$}}{right}}
  \visible<1>{
    \ColorTwo{\TZText{z}{\ExpPhase{\theta}}{above right}}}
  \visible<2->{
    \ColorTwo{\TZText{z}{\ExpPhase{w\cdot 2\pi}}{above right}}}
}
\visible<9->{%
  \draw[->,ultra thick,\RCthree] (0,0) -- (1,0);
  \visible<9>{\ColorThree{\TZPoint{1,0}{$\ExpPhase{0}=+1$}{above right}}}
  \visible<10->{%
  \draw[->,thick,\RCtwo] (1,0) arc (0:20:1) coordinate (z2);
  \draw[thick,dotted] (0,0) -- (z2);
  \ColorTwo{\TZText{z2}{\ \ExpPhase{w\cdot 2\pi\cdot 1}}{right}}}
  \visible<11->{%
 \draw[->,thick,\RCone] (1,0) arc (0:40:1) coordinate (z3);
 \draw[thick,dotted] (0,0) -- (z3);
 \ColorOne{\TZText{z3}{\ \ExpPhase{w\cdot 2\pi\cdot 2}}{right}}}
 \visible<12->{%
 \draw[->,thick,\RCone] (1,0) arc (0:60:1) coordinate (z4);
 \draw[thick,dotted] (0,0) -- (z4);
 \ColorOne{\TZText{z4}{\ \ExpPhase{w\cdot 2\pi\cdot 3}}{above right}}}
 \visible<13->{%
 \draw[->,thick,\RCone] (1,0) arc (0:80:1) coordinate (z5);
 \draw[thick,dotted] (0,0) -- (z5);
 \ColorOne{\TZText{z5}{\raisebox{4pt}{\ \ExpPhase{w\cdot 2\pi\cdot 4}}}{above right}}}
}
\end{TIKZP}}
}{%
\only<1-7>{%
\begin{itemize}
    \item<1-> The basis states will be related to each other in phase by a constant shift of $\theta$ radians.
    \item<2-> We capture the extent of the rotation by $\ColorTwo{w}, 0\leq \ColorTwo{w} < 1$, which represents a fraction of a complete rotation of $2\pi$ radians.
    \item<3-> Each \ColorOne{subsequent basis vector} has amplitude shifted by $\ColorTwo{w}\cdot 2\pi$ radians.
    \item<7-> We generate as many of these as need to cover the basis vectors, $2^n$ for $n$~qbits.
\end{itemize}}
\only<8->{%
\begin{itemize}
    \item<8-> Global phase consists of a uniform rotation of all points on the complex circle. 
    \item<9-> We can therefore assert that the first point occurs at $+1$.
    \item<10-> Each \ColorOne{subsequent point} is $\ColorTwo{w}\cdot 2\pi$ radians counterclockwise on the circle.
    \item<14-> We can characterize these as
    \[ \ExpPhase{w\cdot 2\pi \cdot y}, 0\leq y < 5\]
\end{itemize}}
}
\end{frame}

\begin{frame}{Periodic states}{definition}

A \emph{periodic state} \QState{} for $n$ qubits can be described as:
\[
\QState{} = \RootTwoN{n}\SumPH{y}{n} \ExpPhase{2\pi wy} \ket{y}
\]
for a constant $w, 0 \leq w < 1$.
\begin{itemize}
    \item<2-> Some sources include~$1$ in the upper bound for~$w$, but it's the same as~$w=0$.
    \item<3-> The iteration variable $y$ interprets the binary string encoding a basis vector as a number.
    \item<4-> The basis states all have the same magnitude~\RootTwoN{}, so each is equally likely upon measurement.
\end{itemize}
    
\end{frame}

{
\def\V#1#2{\visible<#1->{\alert<#1>{\ExpPhase{2\pi \ColorTwo{\frac{1}{8}}\cdot #2}}}}
\begin{frame}{A column-vector view}{Of a periodic state}
\TwoColumns{%
\adjustbox{valign=t, width=\textwidth}{\begin{TIKZP}
\UnitComplexCircle{}
\visible<2,6->{%
\draw[->,ultra thick,\RCthree] (0,0) -- (1,0);
  \ColorThree{\TZPoint{1,0}{\ExpPhase{0}}{above right}}
}
\visible<3,6->{%
\draw[->,thick,\RCone] (1,0) arc (0:45:1) coordinate (z2);
  \draw[thick,dotted] (0,0) -- (z2);
  \ColorOne{\TZText{z2}{\ \ExpPhase{\frac{\pi}{4}}}{right}}
}
\visible<4,6->{%
\draw[->,thick,\RCone] (1,0) arc (0:90:1) coordinate (z3);
  \draw[thick,dotted] (0,0) -- (z3);
  \ColorOne{\TZText{z3}{\ \ExpPhase{\frac{\pi}{2}}}{above right}}
}
\visible<5,6->{%
\draw[->,thick,\RCone] (1,0) arc (0:135:1) coordinate (z4);
  \draw[thick,dotted] (0,0) -- (z4);
  \ColorOne{\TZText{z4}{\ \ExpPhase{\frac{3\pi}{4}}}{above left}}
}
\end{TIKZP}}
}{%
\ColorTwo{\[w = \frac{1}{8} \]}
\[\RootTwoN{n}\DQB{\V{2}{0}}{\V{3}{1}}{\V{4}{2}}{\V{5}{3}}\]
}
\end{frame}}

\begin{frame}{Some familiar periodic states}{We saw these before but now regard them as taking a trip around the unit complex circle}

\Vskip{-5em}\TwoColumns{%
\begin{align*}
    \ket{+} &= \QPlus{} \\
           \visible<2->{ &=  \RootTwoN{1}\left(\ColorOne{\ExpPhase{0}}\QZero{} \visible<3->{+ \ColorTwo{\ExpPhase{0}}\QOne{}}\right) \\}
        \visible<4->{    &= \RootTwoN{1}\SumPH{y}{1} \ExpPhase{2\pi\cdot \ColorFour{0}\cdot y} \ket{y}, \ColorFour{w=0}}
\end{align*}
}{%
\begin{align*}
    \ket{-} &= \QMinus{} \\
           \visible<5->{ &=  \RootTwoN{1}\left(\ColorOne{\ExpPhase{0}}\QZero{} \visible<6->{- \ColorTwo{\ExpPhase{0}}\QOne{}}\right) \\}
        \visible<7->{    &= \RootTwoN{1}\SumPH{y}{1} \ExpPhase{2\pi\cdot \ColorFour{\frac{1}{2}}\cdot y} \ket{y}, \ColorFour{w=\frac{1}{2}}}
\end{align*}
}
\Vskip{-4em}\TwoColumns{%
\begin{center}
\adjustbox{valign=t, width=0.6\textwidth}{\begin{TIKZP}
\UnitComplexCircle{}
  \visible<2->{
  \draw[->,ultra thick,\RCone] (0,0) -- (1,0);
  \ColorOne{\TZPoint{1,0}{\ExpPhase{0}}{above right}}}
  \visible<3->{
  \draw[->,ultra thick,\RCtwo] (0,0) -- (1,0);
  \ColorTwo{\TZPoint{1,0}{\ \ \ \ \ \ \ExpPhase{0}}{above right}}}

\end{TIKZP}}
\end{center}
}{%
\begin{center}
\adjustbox{valign=t, width=0.6\textwidth}{\begin{TIKZP}
\UnitComplexCircle{}
  \visible<5->{
  \draw[->,ultra thick,\RCone] (0,0) -- (1,0);
  \ColorOne{\TZPoint{1,0}{\ExpPhase{0}}{above right}}}
  \visible<6->{
  \draw[->,ultra thick,\RCtwo] (0,0) -- (-1,0);
  \ColorTwo{\TZPoint{-1,0}{\ExpPhase{\pi}}{above left}}}

\end{TIKZP}}
\end{center}
}
    
\end{frame}

\begin{frame}{Phase estimation}{Of periodic states}

\begin{itemize}[<+->]
    \item Since $0\leq w < 1$, we can approximate $w$ using the binary fraction
    \[ \LBP{}w_{1}w_{2}\cdots w_{n}\]
    for $n$ bits, where each is~$0$ or~$1$.
    \item For a single qubit to characterize phase, we have
    \begin{description}
        \item[$w=0$]  $\LBP{}w_{1}=.0$ characterizes \ket{+} exactly
        \item[$w=\frac{1}{2}$] $\LBP{}w_{1}=.1$ characterizes \ket{-} exactly
    \end{description}
    \item No extra precision is required to capture \ket{+} or \ket{-}, but other periodic states require more qubits for more precision.
    \item Some periodic states cannot be captured precisely with any number of qubits:
    \begin{itemize}
        \item A state whose period is irrational
        \item A state whose period is rational but whose base-$2$ representation does not terminate
    \end{itemize}
\end{itemize}
    
\end{frame}

\begin{frame}{Phase estimation}{Problem statement}

Given \emph{periodic state} \QState{} for $n$ qubits: 
\[
\QState{} = \RootTwoN{n}\SumPH{y}{n} \ExpPhase{2\pi wy} \ket{y},  0 \leq w < 1
\]
use $n$ qubits to compute an $n$-bit estimation of $w$:
\[
w \approx \LBP{}w_{1}w_{2}\cdots w_{n} 
\]
    
\end{frame}

\begin{frame}{Some intuition}{Using the simplest periodic states}

\begin{itemize}[<+->]
    \item If we know $\QState{}=\ket{+}$ or $\QState{}=\ket{-}$
    \item then we know only a single qubit is needed to represent the phase.
    \item $\Hadamard(\QState{})$ yields the bit we seek:
    \begin{description}
        \item[$\QState{}=\ket{+}$] $\Hadamard(\QState{}) = \ket{0}$
        \item[$\QState{}=\ket{-}$] $\Hadamard(\QState{}) = \ket{1}$
    \end{description}
    \item Measuring the outcome of the \Hadamard{} gate provides $\LBP{}w_{1}$ directly.
    \item If we can isolate each bit after a binary point, then we can recover the other binary digits as well, using the \Hadamard{} gate.  This requires:
    \begin{itemize}
        \item Shifting the binary bits left, so that the bit of interest is just after the binary point.
        \item Eliminating any non-zero bits after the bit of interest so we are analyzing only~$.0$ or~$.1$.
    \end{itemize}
\end{itemize}
    
\end{frame}

\begin{frame}{More intuition}{Using an example}

\Vskip{-4em}\TwoColumns{%
\begin{itemize}
    \item<1-> Consider an example \Vskip{-1.2em}\[w=\LBP{}\ColorOne{w_{1}}\ColorTwo{w_{2}}\ColorThree{w_{3}}=\LBP{}\ColorOne{1}\ColorTwo{0}\ColorThree{1}= \frac{5}{8}\]
    \item<7-> Finally, knowing $\ColorTwo{w_2}$ and $\ColorThree{w_3}$, we can rotate, as needed, $\LBP{}\ColorOne{w_1}\ColorTwo{0}\ColorThree{1}$ to obtain
    $\LBP{}\ColorOne{w_1}00$, requiring a rotation of the \ColorThree{third bit} but not the \ColorTwo{second bit}.
    \item<8-> After \Hadamard{} of that state, we obtain $\ColorOne{w_1}=\ColorOne{1}$
    \item<9-> And so we have found
    \[w=\LBP{}\ColorOne{w_{1}}\ColorTwo{w_{2}}\ColorThree{w_{3}}=\LBP{}\ColorOne{1}\ColorTwo{0}\ColorThree{1}\]
\end{itemize}
}{%
\begin{itemize}
    \item<2-> We first shift left by two bits to obtain $\LBP{}\ColorThree{w_{3}}$
    \item<3-> After \Hadamard{} of that state, we obtain $\ColorThree{w_3}=\ColorThree{1}$
    \item<4-> We then shift the original value left by one bit to obtain $\LBP{}\ColorTwo{w_2}\ColorThree{w_3}$.
    \item<5-> Because we already know $\ColorThree{w_3}$ we can take action to rotate the second bit, if necessary (it is!), to obtain $\LBP{}\ColorTwo{w_2}\ColorThree{1}\mapsto \LBP{}\ColorTwo{w_2}0$.
    \item<6-> After \Hadamard{} of that state, we obtain $\ColorTwo{w_2}=\ColorTwo{0}$,
    
\end{itemize}
}
    
\end{frame}

\begin{frame}{Some preliminaries}{Results needed for phase estimation}

\begin{itemize}[<+->]
    \item Consider $\ExpPhase{2\pi w}, w=\LBP{}\ColorOne{w_{1}w_{2}\cdots w_{k}}\ColorTwo{w_{k+1}\cdots w_{n}}$ (base 2)
    \item Multiplying $w$ by a power of two shifts the binary point to the right:
    \begin{align*}
       w &= \LBP{}\ColorOne{w_{1}w_{2}\cdots w_{k}}\ColorTwo{\invisible{\LBP{}}w_{k+1}\cdots w_{n}} \\
       \visible<4->{ 2^{k}w &= \ColorOne{\invisible{\LBP{}}w_{1}w_{2}\cdots w_{k}}\LBP{}\ColorTwo{w_{k+1}\cdots w_{n}},\ 0\leq k\leq n}
    \end{align*}
    
    \item<4-> So in our exponent we have
    {\Large
    \begin{align*}
        \visible<4->{\ExpPhase{2\pi 2^{k}w} &= \ExpPhase{2\pi \ColorOne{w_{1}w_{2}\cdots w_{k}}\LBP{}\ColorTwo{w_{k+1}\cdots w_{n}}}} \visible<5->{=\ExpPhase{2\pi (\ColorOne{w_{1}w_{2}\cdots w_{k}}+\LBP{}\ColorTwo{w_{k+1}\cdots w_{n}})}\\}
        \visible<6->{&= \ExpPhase{2\pi \ColorOne{w_{1}w_{2}\cdots w_{k}}} \times \ExpPhase{2\pi (\LBP{}\ColorTwo{w_{k+1}\cdots w_{n}})} \\}
       \visible<7->{ &= \ColorOne{1} \times \ExpPhase{2\pi (\LBP{}\ColorTwo{w_{k+1}\cdots w_{n}})}, \mbox{\normalsize because $\ExpPhase{2\pi \ColorOne{N}}=\ColorOne{1}$ for any integer \ColorOne{$N$}}}
    \end{align*}}
\end{itemize}


    
\end{frame}

{
\def\T#1{\TwoSupOp{\QZero}{\ExpPhase{2\pi\left(2^{#1}\W{}\right)}\QOne}{+}}
\def\N{\ColorOne{\ensuremath{n}}}\def\W{\ColorTwo{\ensuremath{w}}}
\begin{frame}{Useful theorem}{Needed for phase estimation, prove later}

\Vskip{-3em}\begin{align*}
 \RootTwoN{\N}\SumPH{y}{\N} \ExpPhase{2\pi \W{}y} \ket{y} =& \T{\N{}-1}  \\
 \TensOp{} & \T{\N{}-2} \\
 \TensOp{} & \cdots \\
 \TensOp{} & \T{\N{}-\N{}} 
\end{align*}
\begin{itemize}
    \item This articulates the state of each of the \N{} qubits separately.
    \item Each successive qubit reveals another binary digit of \W{}.
\end{itemize}


\end{frame}
}

{
\def\TB#1#2{\LBP{}\ColorOne{\ensuremath{#1}}\ColorTwo{\ensuremath{#2}}}
\def\WO{\ColorOne{\ensuremath{w_1}}}\def\WT{\ColorTwo{\ensuremath{w_2}}}
\def\TE#1{\TwoSupOp{\QZero{}}{{\large\ExpPhase{2\pi \left(\LBP{}#1\right)}}\QOne{}}{+}}
\begin{frame}{Example using $n=2$ qubits}{Applying the theorem}
\Vskip{-4em}\TwoUnequalColumns{0.37\textwidth}{0.63\textwidth}{%
\ScrollProof{1}{4}{%
\Next{\Four}{\QState{} &= \SumPH{y}{2} \ExpPhase{2\pi wy}\ket{y} \\}
\Next{\Three}{w &= \LBP{}\WO{}\WT{} \\}
\gdef\CarryOne{\QState{} &= \SumPH{y}{2} \ExpPhase{2\pi \left(\LBP{}{\WO{}\WT{}}\right)y}\ket{y}}
\Last{\CarryOne}
}%
\only<5->{%
\begin{align*}
    \CarryOne
\end{align*}}
\only<5->{%

The exact possibilities for $w$:
\begin{center}
    \begin{tabular}{cc}
    \LBP{}\WO\WT & $w$ \\ \hline
    \visible<6->{\TB{0}{0} & \alert<10>{0} \\[0.2em]}%
    \visible<7->{\TB{0}{1} & \alert<11>{$\frac{1}{4}$}\\[0.2em]}%
    \visible<8->{\TB{1}{0} & \alert<10>{$\frac{1}{2}$} \\[0.2em]}%
    \visible<9->{\TB{1}{1} & \alert<11>{$\frac{3}{4}$}}
    \end{tabular}
\end{center}
}
}{%
\only<5->{%
\begin{align*}
= &\ColorThree{\TE{\WT}} \\ \TensOp{} &\ColorFour{\TE{\WO\WT}}
\end{align*}}
\only<10->{%
\begin{description}
    \item<10->[$\Hadamard(\ColorThree{top}) = \ket{0}$] then $\WT=0$, so \TB{w_1}{w_2}=\TB{0}{0}\mbox{ or }\TB{1}{0}. $\Hadamard(\ColorFour{bottom})$ thus yields $w=0$ or~$\frac{1}{2}$.
    \item<11->[$\Hadamard(\ColorThree{top}) = \ket{1}$] then $\WT=1$, so \TB{w_1}{w_2}=\TB{0}{1}\mbox{ or }\TB{1}{1}. We rotate away \WT{} and measure $\Hadamard(\ColorFour{bottom})$, yielding $w=\frac{1}{4}$ or~$\frac{3}{4}$.
\end{description}
But how do we \emph{rotate away}?
}
}
\end{frame}
}




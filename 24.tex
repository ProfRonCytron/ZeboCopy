\SetTitle{24}{Simon's problem}{Harder probabilistically than Deutsch--Jozsa}{24}

\begin{frame}{Overview}{What will we study?}

\begin{itemize}
    \item Review of Deutsch--Jozsa
    \item A good probabilistic algorithm for Deutsch--Jozsa
    \item Simon's problem
    \item Difficulty of a classical solution
    \item Quantum computing solution
    \item An efficient solution to this problem involves both a quantum computer and some processing that would typically be performed on a classical computer.
    \item It has the typical rotate--compute--rotate form of a quantum computation.
    \item It features intentional partial measurement.
    \item It is highly likely to yield results quickly.
    \item However, it is not \emph{guaranteed} to provide an answer in any finite amount of time.
\end{itemize}

\end{frame}

\begin{frame}{Deutsch--Jozsa revisited}{We can solve this efficiently if we give up an exact solution}

\TwoColumns{%
\only<1-13>{%
\begin{itemize}[<+->]
    \item Given $f(x): \BinAlph{n}\mapsto \Set{0,1}$. 
    \item Is $f(x)$
    \begin{description}
        \item[\ColorOne{constant}] $f(x)$ same result for all inputs
        \item[\ColorTwo{balanced}]  $f(x)$ same result for half of its inputs
    \end{description}
    \item Exact solution in $\Theta(2^{n})$ time classically
    \item Exact solution in $\Theta(1)$ time on a quantum computer
\end{itemize}
}%
\only<14-16>{%
\ColorTwo{Suppose $f(x)$ is balanced}
\begin{itemize}
    \item<14-> \alert<14>{Half the time we determine this by $f(x)\not=f(y)$}
    \item<15-> \alert<15>{The other half of the time we are right one-third of the time.}
\end{itemize}
\[ \visible<14->{\frac{1}{2}\left(1\right)}\visible<15->{+ \frac{1}{2}\left(\frac{1}{3}\right)}  \visible<16->{= \frac{2}{3}}\]
}%
\only<17->{%
\ColorOne{Suppose $f(x)$ is constant}
\begin{itemize}
    \item<17-> \alert<17>{We never see $f(x)\not=f(y)$}
    \item<18-> \alert<15>{We correctly say \ColorOne{constant} $\frac{2}{3}$ of the time.}
\end{itemize}
\only<19->{%
This algorithm produces the correct answer with probability~$\frac{2}{3}$.
\QED{}}
}
}{%
\begin{itemize}[<+->]
    \item We can do well if we are willing to take a chance.
    \item Choose $x$ and $y$ randomly from \BinAlph{n}.
    \item \alert<14>{If $f(x)\not=f(y)$ say \ColorTwo{balanced}}
    \item Otherwise
    \begin{itemize}
        \item \alert<15,17>{With probability $\frac{1}{3}$ say \ColorTwo{balanced}}
        \item \alert<18>{With probability $\frac{2}{3}$ say \ColorOne{constant}}
    \end{itemize}
    \item Claim: This produces the correct answer $\frac{2}{3}$ of the time.
\end{itemize}
}
\end{frame}

\begin{frame}{For Deutsch--Jozsa, can we do better?}{We classically improve our chances exponentially with each query}

\begin{itemize}[<+->]
    \item Suppose we are willing to evaluate $f(x)$ $k$ times.
    \item We then say the function is constant iff all evaluations return the same result.
    \item To simplify analysis each $x$ is drawn randomly and uniformly from \BinAlph{n}.
    \item If $f(x)$ is \ColorOne{balanced} what is the probability that after $k$ queries we have seen only the same result?
    \begin{itemize}
        \item After the first query, each subsequent query has probability $\frac{1}{2}$ of having the same result.
        \item The probability of seeing $k-1$ same results is then \[\left(\frac{1}{2}\right)^{k-1} =\ \frac{1}{2^{k-1}}\]
    \end{itemize}
    \item Our certainty that $f(x)$ is constant improves exponentially with each query that returns the same value.
\end{itemize}
    
\end{frame}

\begin{frame}{Simon's problem}{Is difficult probabilistically}
\begin{itemize}[<+->]
    \item Our joy from separating \CompClass{P} from \CompClass{EQP} is tempered when we realize we can solve Deutsch--Jozsa with high probability using a small number of queries.
    \item Simon's problem considers 
    \begin{itemize}
        \item a function $f: \BinAlph{n}\mapsto \BinAlph{n-1}$
        \item a secret $\AllBits{s}{n} \not= 0^{n}$
    \end{itemize}
    \item with the following property:
    \[\Forall{\AllBits{x}{n}}{f(x)=f(\Xor{x}{s})} \]
    \item In other words, each \AllBits{x}{n} has a \emph{buddy}~\Xor{x}{s} whose value in $f$ is identical.
    \item Note that the buddy of $x$'s buddy is $x$, because
    $\Forall{x}{\Xor{(\Xor{x}{s})}{s}=x}$.
    \item \alert{Simon's problem is to determine the value of~$s$.}
\end{itemize}
\end{frame}

{
\def\R#1#2#3{\alert<#1>{#2} & \alert<#1>{#3}}
\begin{frame}{Simon's problem}{Example $n=3$}
What is $s$?  \visible<4->{101}
\TwoColumns{%
\begin{center}
    \begin{tabular}{c|c}
        $x$ & $f(x)$ \\ \hline
         \R{2-3,12}{000}{01} \\
        \R{4-5,11}{001}{00} \\
         \R{6-7,14}{010}{11} \\
         \R{8-9,13}{011}{10} \\
         \R{5,11}{100}{00} \\
         \R{3,12}{101}{01} \\
         \R{9,13}{110}{10} \\
         \R{7,14}{111}{11}
    \end{tabular}
\end{center}
}{%
\only<2-9>{%
\begin{itemize}
    \item<3-> $\Xor{000}{101}=101$
    \item<4-> $\Xor{001}{101}=100$
    \item<6-> $\Xor{010}{101}=111$
    \item<8-> $\Xor{011}{101}=110$
\end{itemize}
}%
\only<10->{%
\begin{center}
Buddies \\[1em]
    \begin{tabular}{c|cccc}
      $f(x)$   & \alert<11>{00}  & \alert<12>{01} & \alert<13>{10} & \alert<14>{11}  \\ \hline
       $x$     & 001 & 000 & 011 & 010 \\
       buddy   & 100 & 101 & 110 & 111
    \end{tabular}
\end{center}
}
}
\end{frame}}

\begin{frame}{Before we go further, is this problem difficult probabilistically?}{It is related to the birthday problem}

\begin{itemize}[<+->]
    \item Consider a year of $d=2^{n-1}$ days (function values).
    \item A room of $2^{n}$ people (function inputs).
    \item In the room exactly one pair (buddies) share the same birthday.
    \item We need to find two people with the same birthday.   Once we know their \Quote{names} we can compute the secret~$s$.
    \item For an exact answer, we may need to examine $2^{n-1}+1$ people worst-case, as with the Deutsch--Jozsa problem.
    \item For a probabilistic approach, the \href{https://en.wikipedia.org/wiki/Birthday_problem\#Probability_of_a_shared_birthday_(collision)}{shared-birthday problem} defines $f(p,d)$  as the \emph{approximate} number of queries needed to find~2 identical values among~$d$ possible values with probability $p$:
    \[ f(p,d)= \sqrt{2d\times \ln\left(\frac{1}{1-p}\right)}\]
\end{itemize}
\end{frame}

\begin{frame}{How many queries?}{To find a pair of buddies}
\Vskip{-3.5em}\begin{itemize}[<+->]
\item Given $d$ possible values, we need approximately this many queries to find a pair of buddies with probability $p$:
 \Vskip{-1em}\[ f(p,d)= \sqrt{2d\times \ln\left(\frac{1}{1-p}\right)}\]
\item We have $2^{n-1}$ possible values, so
\Vskip{-1em}\[ f(p,2^{n-1})= \sqrt{2^{n} \ln\left(\frac{1}{1-p}\right)}\]
\item For any fixed probability $p$, or more generally when $p$ is not a function of $n$, this becomes~$\Omega(2^n)$.
\item We thus expect we will need an \emph{exponential} number of queries to find one pair of buddies for this problem to find the solution with probability~$p$.
\end{itemize}

\end{frame}

\begin{frame}{Oracle}{Wider inputs and outputs than before}
\Vskip{-4em}\TwoColumns{%
\Vskip{-3em}\begin{center}
    \begin{GateBox}{2}{4}{8}
    \draw[dashed,blue] (-1,2) -- ++(5,0);
    \BoxLabel{\raisebox{2em}{$U_f$}}
    \visible<1->{%
    \Input{0}{$x_1$}\Output{0}{$x_1$}
    \Input{1}{$x_2$}\Output{1}{$x_2$}
    \Input{2}{\RVDots}\Output{2}{\RVDots}
    \Input{3}{$x_n$}\Output{3}{$x_n$}%
    }%
    \visible<2->{%
    \Input{4}{$b_1$}
    \Input{5}{$b_2$}
    \Input{6}{\RVDots}
    \Input{7}{$b_{n-1}$}}
    \visible<3->{%
    \Output{4}{$\Xor{b_1}{f(x)_{1}}$}
    \Output{5}{$\Xor{b_2}{f(x)_{2}}$}
    \Output{6}{\RVDots}
    \Output{7}{$\Xor{b_{n-1}}{f(x)_{n-1}}$}}
    \end{GateBox}
\end{center}
}{%
\begin{itemize}[<+->]
    \item There are $n$ qubits for the input $x$, which $U_f$ sends to the top $n$~qubits of the output.
    \item There are also $n-1$ qubits for an input $b$.
    \item The oracle places \Xor{b}{f(x)} on the bottom $n-1$~qubits.
\end{itemize}
}

\BigSkip{}
\begin{itemize}
    \item<1-> Create the superposition of all inputs for $x$.
    \item<2-> Supply \QZero{} for each qubit of $b$.
    \item<4-> Result is the superposition of each \AllBits{x}{n} and $f(x)$!
\end{itemize}
\end{frame}

\begin{frame}{Solution for Simon's problem}{Circuit and analysis}
\begin{center}
\Vskip{-3em}\adjustbox{valign=t, width=0.7\textwidth}{\begin{quantikz}
\lstick{\ket{\TensSupProd{0}{n}}} & \qwbundle{\alert<1>{n}} & \qw\slice{\alert<4>{\QState{0}}}& \gate{\alert<3>{\TensSupProd{\Hadamard}{n}}}\slice{\alert<5-9>{\QState{1}}} & \gate[wires=2][5em]{\mbox{$U_f$}}\gateinput{$x$}\gateoutput{$x$}\slice{\alert<10-18>{\QState{2}}} &\qw\slice{\alert<19>{\QState{3}}}  & \gate{\alert<3>{\TensSupProd{\Hadamard}{n}}}\slice{\QState{4}} & \meter{} & \qw \\
\lstick{\alert<2>{\ket{\TensSupProd{0}{n-1}}}} &  \qwbundle{\alert<1>{n-1}} & \qw & \qw   &  \qw\gateinput{$b$}\gateoutput{\Xor{b}{f(x)}} & \meter{} & \qw & \qw & \qw
\end{quantikz}}
\end{center}
\only<1-3>{%
\begin{itemize}
    \item<1-> There are $n$~qubits at the top and $n-1$ qubits at the bottom.
    \item<2-> The bottom inputs are all \QZero{}.
    \item<3-> We perform an $n$-way Hadamard transformation on the top qubits before and after the oracle.
\end{itemize}
}%
\Vskip{-2.5em}
\ScrollProof{4}{8}{%
\Next{\Four}{\QState{0} &= \ket{\TensSupProd{0}{n}}\ket{\TensSupProd{0}{n-1}} \\}
\Next{\Three}{\QState{1} &= \TensProd{\TensSupProd{\Hadamard}{n}\ket{\TensSupProd{0}{n}}}{\ket{\TensSupProd{0}{n-1}}} \\}
\Next{\Two}{ &= \RootTwoN{n}\TensProd{\SumBV{x}{n}\ket{x}}{\ket{\TensSupProd{0}{n-1}}} \\}
\gdef\CarryOne{\sqrt{2^n}\QState{1} &= \SumBV{x}{n}\ket{x}\ket{\TensSupProd{0}{n-1}}}
\Last{\CarryOne}
}
\ScrollProof{9}{12}{%
\Next{\Four}{\CarryOne{} \\}
\Next{\Three}{\sqrt{2^n}\QState{2} = \sqrt{2^n}U_{f}(\QState{1}) &= U_{f}\left(\SumBV{x}{n}\ket{x}\ket{\TensSupProd{0}{n-1}}\right) \\}
\gdef\CarryTwo{\sqrt{2^n}\QState{2} &= \SumBV{x}{n}\ U_{f}\left(\ket{x}\ket{\TensSupProd{0}{n-1}}\right)}
\Last{\CarryTwo}
}
\ScrollProof{13}{16}{%
\Next{\Four}{\CarryTwo \\}
\Next{\Three}{ &= \SumBV{}{n}\ \ket{x}\ket{\Xor{0^{n-1}}{f(x)}} \\}
\gdef\CarryThree{\QState{2} &= \RootTwoN{n}\SumBV{x}{n}\ \ket{x}\ket{f(x)}}
\Last{\CarryThree}
}
\ScrollProof{17}{19}{%
\Next{\Three}{\CarryThree}
}
\only<17->{%
\Vskip{-2.5em}\begin{itemize}
    \item<17-> This is a remarkable state in that it contains the uniform superposition of \emph{every possible} input $x$ (the top~$n$ qubits) and its evaluation $f(x)$ (the bottom~$n-1$ qubits).
    \item<18-> Measurement of all qubits will yield a randomly chosen \TensProd{x}{f(x)}, but this doesn't tell us anything about $x$'s buddy.
    \item<19-> What happens at \QState{3}, where we measure \only{only} the bottom qubits?
\end{itemize}
}
\end{frame}
{
\def\R#1#2#3{\alert<#1>{#2} & \alert<#1>{#3}}
\begin{frame}{\vrule width0pt depth2.2em Example measuring $\QState{2} = \RootTwoN{n}\SumBV{x}{n}\ \ket{x}\ket{f(x)}$}

\Vskip{-4em}\TwoUnequalColumns{0.2\textwidth}{0.8\textwidth}{%
\begin{center}
    \begin{tabular}{c|c}
        $x$ & $f(x)$ \\ \hline
         \R{8-9}{000}{01} \\
         \R{1,10}{001}{00} \\
         \R{5}{010}{11} \\
         \R{7}{011}{10} \\
         \R{3,10}{100}{00} \\
         \R{8-9}{101}{01} \\
         \R{7}{110}{10} \\
         \R{2,4}{111}{11}
    \end{tabular}
\end{center}
}{%
\only<1-5>{%
\begin{itemize}
  \item<1-> Each measurement of \QState{2} will yield a random $\ket{x}\ket{f(x)}$.
  \item<2-> We run this circuit many times, but each outcome is random.
  \item<4-> And we may see a measurement we have seen before.
  \item<5-> This is no better than classically evaluating $f(x)$.
\end{itemize}}%
\only<6->{%
\begin{itemize}
    \item<6-> What happens if we measure only the \emph{bottom}~$n-1$ qubits?
    The system must collapse into a state consistent with what we observe.  
    
    \item<7-> Thus if we measure \ket{\alert<7>{10}} in the bottom qubits, then the top qubits collapse into \TwoSup{\alert<7>{011}}{\alert<7>{110}}.
    \item<8-> As another example, measuring \ket{\alert<8>{01}} at the bottom yields \TwoSup{\alert<8>{000}}{\alert<8>{101}} at the top.
    \item<9-> These partial measurements don't help:  Sampling the top qubits will yield \ket{\alert<9>{000}} or \ket{\alert<9>{101}}.
    \item<10-> Running the circuit again will yield another random measurement on the bottom qubits, with a concomitant collapse of the top qubits' state.
\end{itemize}}
}
    
\end{frame}}

\begin{frame}{Analysis from \QState{3}}{The partial measurement does help, partially}
\begin{center}
\Vskip{-3em}\adjustbox{valign=t, width=0.7\textwidth}{\begin{quantikz}
\lstick{\ket{\TensSupProd{0}{n}}} & \qwbundle{n} & \qw\slice{\QState{0}}& \gate{\TensSupProd{\Hadamard}{n}}\slice{\QState{1}} & \gate[wires=2][5em]{\mbox{$U_f$}}\gateinput{$x$}\gateoutput{$x$}\slice{\alert<5>{\QState{2}}} &\qw\slice{\alert<6>{\QState{3}}}  & \gate{\TensSupProd{\Hadamard}{n}}\slice{\alert<7->{\QState{4}}} & \meter{} & \qw \\
\lstick{\ket{\TensSupProd{0}{n-1}}} &  \qwbundle{n-1} & \qw & \qw   &  \qw\gateinput{$b$}\gateoutput{\Xor{b}{f(x)}} & \meter{} & \qw & \qw & \qw
\end{quantikz}}
\end{center}
\only<1-4>{%
\begin{itemize}
    \item<1-> Measuring the bottom qubits yields some state \ket{f(x)} that we will ignore.
    \item<2-> Of greater importance, the measurement places the top qubits into the state~\TwoSup{x}{\Xor{x}{s}} at \QState{3}.
    \item<3-> The computation finishes with an $n$-way Hadamard transformation of \QState{3}, which will provide clues about the secret~$s$.
    \item<4-> We restrict our state analysis to the top~$n$ qubits going forward.
\end{itemize}
}%
\Vskip{-2.5em}
\ScrollProof{5}{8}{%
\Next{\Four}{\sqrt{2^n}\QState{2} &= \RootTwoN{n}\SumBV{x}{n}\ \ket{x}\ket{f(x)} \\}
\Next{\Three}{\QState{3} &= \TwoSup{x}{\Xor{x}{s}} \\}
\Last{\sqrt{2}\QState{4} &= \TensSupProd{\Hadamard}{n}\left(\ket{x} + \ket{\Xor{x}{s}}\right) = \TensSupProd{\Hadamard}{n}(\ket{x}) + \TensSupProd{\Hadamard}{n}(\ket{\Xor{x}{s}})}
}%
\ScrollProof{9}{12}{%
\Next{\Four}{\sqrt{2}\QState{4} &= \ColorOne{\TensSupProd{\Hadamard}{n}(\ket{x})} + \ColorTwo{\TensSupProd{\Hadamard}{n}(\ket{\Xor{x}{s}})} \\}
\Next{\Three}{\mbox{Recall: }\TensSupProd{\Hadamard}{n}\ket{z} &= \RootTwoN{n}\NHadamard{z}{n}{w} \\}
\gdef\CarryOne{\sqrt{2^n}\sqrt{2}\QState{4} &= \ColorOne{\NHadamard{x}{n}{w}} + \ColorTwo{\NHadamard{(\Xor{x}{s})}{n}{w}}}
\Last{\CarryOne}
}%
\ScrollProof{13}{16}{%
\Next{\Four}{\CarryOne \\}
\Next{\Three}{ &= \SumBV{w}{n} \ColorOne{\NegOneExp{\DotP{x}{w}}} + \ColorTwo{\NegOneExp{\DotP{(\Xor{x}{s})}{w}}}\ \ket{w} \\}
\gdef\CarryTwo{\sqrt{2^{n+1}}\QState{4} &= \SumBV{w}{n} \ColorOne{\NegOneExp{\DotP{x}{w}}} + \ColorTwo{\NegOneExp{\Xor{(\DotP{x}{w})}{(\ColorFour{\DotP{s}{w}})}}}\ \ket{w}}
\Last{\CarryTwo}
}%
\only<17->{%
\begin{align*}
    \CarryTwo{}
\end{align*}
}
\only<17-20>{%
\Vskip{-2em}\begin{itemize}
    \item<18-> All dot products and \Xor{}{} operations are either~$0$ or~$1$.  The \ColorOne{first} and \ColorTwo{second} terms in the sum are thus $\pm 1$.
    \item<19-> The value of \ColorOne{\DotP{x}{w}} is of course identical to \ColorTwo{\DotP{x}{w}}. However, if \ColorFour{\DotP{s}{w}} is~$1$ then
    $\ColorOne{\NegOneExp{\DotP{x}{w}}} + \ColorTwo{\NegOneExp{\Xor{(\DotP{x}{w})}{\ColorFour{1}}}}=0$, canceling the basis state \ket{w} in \QState{4}.
    \item<20-> This depends on the secret~$s$ and on the
    particular value of term~$w$.
\end{itemize}}
\only<21-23>{%
\Vskip{-2em}%
Two cases:
\begin{description}
   \item<21->[$\ColorFour{\DotP{s}{w}}=1$] There is no amplitude on the \ket{w}.
   \item<22->[$\ColorFour{\DotP{s}{w}}=0$] The coefficient on \ket{w} is $\pm 2$.  Its probability is then $\left(\frac{\pm 2}{\sqrt{2^{n+1}}}\right)^{2}=\frac{1}{2^{n-1}}$
\end{description}
\visible<23->{For any $s\not=\TensSupProd{0}{n}$, the two cases occur with equal frequency:  half of \AllBits{w}{n}.  We can rewrite \QState{4} to reflect only observable outcomes.}
}%
\only<24->{%
\[
\QState{4} \equiv \RootTwoN{n-1}\sum_{w\ |\ \DotP{s}{w}=0}\ \ket{w}
\]
We are equally likely to see any outcome \ket{w} such that its dot product with~$s$ is~$0$.
}
    
\end{frame}

\begin{frame}{How to find the secret $s$}{It takes multiple runs of the circuit, but each can provide a clue}

\begin{itemize}
    \item Each time we run the circuit, we observe a \ket{w} such that $\DotP{w}{s}=0$.
    \item We first use an example to build intuition about the clues such \ket{w} observables provide.
    \item We then turn to formalizing the solution to Simon's problem and its efficiency on a quantum computer.
\end{itemize}
    
\end{frame}

{
\def\R#1#2#3{#1 & #2 & #3}
\def\RA#1#2#3#4{\alert<#1>{#2} & \alert<#1>{#3} & \alert<#1>{#4}}
\begin{frame}{Observations using our example}{Building intuition about finding the secret~$s$}
\Vskip{-3em}\TwoUnequalColumns{0.3\textwidth}{0.7\textwidth}{%
\begin{center}
    \begin{tabular}{ccc}
    \multicolumn{3}{c}{$s=101$} \\
    $w$ & \And{w}{s} & \DotP{w}{s} \\ \hline
        \RA{2-3}{000}{000}{0} \\
        \R{001}{001}{1} \\
        \RA{2-3}{010}{000}{0} \\
        \R{011}{001}{1} \\
        \R{100}{100}{1} \\
        \RA{2-3}{101}{101}{0} \\
        \R{110}{100}{1} \\
        \RA{2-3}{111}{101}{0}
    \end{tabular}
\end{center}
}{%
\begin{itemize}
    \item<1-> The table shows \DotP{w}{s} for each basis state \ket{w}.
    \item<2-> The only \emph{observable} states \ket{w} are those for which $\DotP{w}{s}=0$ for our secret~$s$.  All other states have~$0$ amplitude and thus no probability of measurement.
    \item<3-> Each of the \alert{four} states is observed with probability $\frac{1}{4}$.
    \begin{description}
        \item[000]
        \item[010]
        \item[101]
        \item[110]
    \end{description}
\end{itemize}
}
    
\end{frame}
\def\S#1#2#3#4{#1 & 0 & \visible<3->{#2} & \visible<5->{#3} & \visible<7->{#4}}
\begin{frame}{What does each $w$ tell us about $s$?}
\TwoUnequalColumns{0.5\textwidth}{0.5\textwidth}{%
\begin{center}
    \begin{tabular}{ccccc}
                    & \multicolumn{4}{c}{Possible observation $w$} \\
                    & \alert<1-2>{000} & \alert<3-8>{010} & 111 & 101 \\
   $s$? & {\small\DotP{s}{000}} & {\small\DotP{s}{010}} & {\small\DotP{s}{111}} & {\small\DotP{s}{101}} \\ \hline%
        \invisible<9->{\S{000}{0}{0}{0}} \\
         \invisible<15-17>{\S{\alert<11-17,19->{001}}{0}{1}{1}} \\
         \invisible<8-17>{\S{\alert<4-17>{010}}{1}{1}{0}} \\
         \invisible<8-17>{\S{\alert<5-17,20->{011}}{1}{0}{1}} \\
         \invisible<15-17>{\S{\alert<13-17,21->{100}}{0}{1}{1}} \\
         \S{\alert<16>{101}}{0}{0}{0} \\
         \invisible<8-17>{\S{\alert<6-17,22->{110}}{1}{0}{1}} \\
         \invisible<8-17>{\S{\alert<7-17>{111}}{1}{1}{0}}
    \end{tabular}
\end{center}}{%
\only<1-2>{
\begin{itemize}
    \item We can always observe \TensSupProd{0}{n} because its dot product with any~$s$ is $0$.
    \item However, it does not narrow the field of possible $s$ candidates.
    \item<2-> Any putative $s$ whose inner product with the observed~$w$ is $1$ cannot be our secret.
\end{itemize}}%
\only<3-9>{%
\begin{itemize}
    \item<3-> Observing 010 eliminates
    \begin{itemize}
        \item<4-> 010
        \item<5-> 011
        \item<6-> 110 
        \item<7-> 111
    \end{itemize}
    \item<8-> Our secret $s$ could be any of the remaining values except $000$, which is never our secret.
    \item<9-> So we can eliminate it from consideration.
\end{itemize}}%
\only<10-17>{%
\begin{itemize}
    \item<10-> Observation 111 eliminates
    \begin{itemize}
        \item<11-> 001
        \item<12-> 010 (already gone)
        \item<13-> 100 
        \item<14-> 111 (already gone)
    \end{itemize}
    \item<15-> So we eliminate those.
    \item<16-> We find our secret $s=101$ as the only possibility remaining.
    \item<17-> For completeness we show observation 101 next.
\end{itemize}}
\only<18->{%
\begin{itemize}
    \item<18-> Observation 101 eliminates
    \begin{itemize}
        \item<19-> 001
        \item<20-> 011
        \item<21-> 100
        \item<22-> 110
    \end{itemize}
\end{itemize}}
}%
\end{frame}
}
\begin{frame}{Some concerns about this approach}{This small example may be deceiving}

\begin{itemize}[<+->]
    \item How large are these tables for $n$~qubits?
    \item They are $\Theta(2^n)$, which is as bad as the classical time bound.
    \item What is the count of observations $w$ such that $\DotP{w}{s}=0$?
    \item Half of the basis states, so this count is also $\Theta(2^n)$.   
    \item We better not need to see very many observations to find $s$.
    \item And how do we find $s$ without eliminating impossible solutions from a large table?
    \item We will focus on the bits of $s$, as there are only $n$ of them.
    \item We will use Gaussian elimination, whose complexity is $\Theta(n^{3})$
\end{itemize}
    
\end{frame}

\begin{frame}{Our example revisited}{We use logic to determine the bits of $s$}

\begin{itemize}
    \item We consider $s=s_{1}s_{2}s_{3}$ so we can reason about the bits of $s$ separately.  Since $s$ does not necessarily denote a binary numerical value, we are free to number these left-to-right, as shown.
    \item Each observable value $w$ can provide clues about the bits of $s$, as follows:
\begin{description}
   \item[010]  Because $\DotP{010}{s_{1}s_{2}s_{3}}=0$, we can conclude $s_{2}=0$.
   \item[101]  We now require \[
   \Implies{\DotP{101}{s_{1}0s_{3}}=0}{\Xor{s_1}{s_3}=0}\]
   Thus $s_1$ and $s_3$ are either both~$0$ or both~$1$.
\end{description}
   \item Since $s=000$ is not allowed, we must have the latter case.  
   \item This yields the correct answer, $s=101$
\end{itemize}

    
\end{frame}
{
\def\L#1{\raisebox{-0.65em}{#1}}
\begin{frame}{Formalizing this logic}{Using Gaussian elimination}
\begin{center}
\begin{tabular}{rclcc}
\begin{DotPBox}{3}{1}{3}
\Qbit{0}{1}
\Qbit{1}{1}
\Qbit{2}{0}
\end{DotPBox} & & \begin{DotPBox}{1}{1}{1}\Qbit{0}{s_1}\end{DotPBox}  & & \L{0}\\
\begin{DotPBox}{3}{1}{3}
\Qbit{0}{1}
\Qbit{1}{0}
\Qbit{2}{1}
\end{DotPBox}& \L{\FCirc{0.3}} & \begin{DotPBox}{1}{1}{1}\Qbit{0}{s_2}\end{DotPBox}  &\L{=}& \L{0}\\
\begin{DotPBox}{3}{1}{3}
\Qbit{0}{1}
\Qbit{1}{1}
\Qbit{2}{0}
\end{DotPBox}& & \begin{DotPBox}{1}{1}{1}\Qbit{0}{s_3}\end{DotPBox} & & \L{0}
\end{tabular}
\end{center}
\begin{itemize}
    \item Each $w$ is a row of the above matrix, and its dot product with the column vector~$s$ must be $0$.
    \item To obtain a solution, we need $n$ linearly independent rows.
    \item Performing \href{https://en.wikipedia.org/wiki/Gaussian_elimination}{Gaussian elimination} on the system to obtain $s$ takes $\Theta(n^{3})$ time using the most common algorithm.  Multiplication and addition are \And{}{} and \Xor{}{} here.
\end{itemize}
    
\end{frame}



\begin{frame}{Larger example, $n=4$ qubits}{Let's find $s$ as Simon would}
\TwoColumns{%
\only<1-13>{%
Suppose we see $w$ observations in the following order:
\begin{itemize}
    \item<2-> 0101
    \item<4-> 1010
    \item<6-> 0000
    \item<8-> 1111
    \item<10-> 1011
    \item<12-> 0001
\end{itemize}}%
\only<14->{%
\begin{itemize}
    \item<14-> From row~4 we obtain $s_{4}=0$.
    \item<15-> So we know its value.
    \item<16-> From row~1 we now obtain $s_{2}=0$.
    \item<18->Row~2 or ~3 can be used to show $s_{1}=s_{3}=1$
    \item<20-> We thus obtain $s=1010$.
\end{itemize}
}
}{%
\begin{center}
\begin{tabular}{rclcc}
\visible<3->{\begin{DotPBox}[scale=0.7]{3}{1}{4}
\Qbit{0}{0}
\Qbit{1}{\alert<16>{1}}
\Qbit{2}{0}
\Qbit{3}{1}
\end{DotPBox}} & & \begin{DotPBox}[scale=0.7]{1}{1}{1}\Qbit{0}{\alt<19->{1}{\alert<18>{s_1}}}\end{DotPBox}  & & \L{0}\\
\visible<5->{\begin{DotPBox}[scale=0.7]{3}{1}{4}
\Qbit{0}{1}
\Qbit{1}{0}
\Qbit{2}{1}
\Qbit{3}{0}
\end{DotPBox}}& \L{\FCirc{0.3}} & \begin{DotPBox}[scale=0.7]{1}{1}{1}\Qbit{0}{\alert<16>{\alt<17->{\alert<17>{0}}{s_2}}}\end{DotPBox}  &\L{=}& \L{0}\\
\visible<11->{\begin{DotPBox}[scale=0.7]{3}{1}{4}
\Qbit{0}{1}
\Qbit{1}{0}
\Qbit{2}{1}
\Qbit{3}{1}
\end{DotPBox}}& & \begin{DotPBox}[scale=0.7]{1}{1}{1}\Qbit{0}{\alt<19->{1}{\alert<18>{s_3}}}\end{DotPBox} & & \L{0} \\
\visible<13->{\begin{DotPBox}[scale=0.7]{3}{1}{4}
\Qbit{0}{0}
\Qbit{1}{0}
\Qbit{2}{0}
\Qbit{3}{\alert<14-15>{1}}
\end{DotPBox}}& & \begin{DotPBox}[scale=0.7]{1}{1}{1}\Qbit{0}{\alt<15->{\alert<15>{0}}{\alert<14>{s_4}}}\end{DotPBox} & & \L{0}
\end{tabular}
\end{center}
\BigSkip{}
\only<3>{%
We accept this as the first equation and set the matrix values accordingly.
}%
\only<5>{%
This is another, independent $w$ and we use it as the second equation.
}%
\only<9>{%
This value is in the span of the first two ($\Xor{0101}{1010}=11111$) so it does not contribute a linearly independent row to our developing matrix.  We do not use this observation.}%
\only<7>{%
$w=0000$ never reveals anything of $s$, so we reject this.}%
\only<11>{%
This is our third equation.
}%
\only<13>{%
Our fourth equation
}
}
\end{frame}

\def\G#1#2#3{\alert<1>{#1} & #2 & #3}
\def\B#1#2#3{\invisible<2->{#1 & #2 & #3}}
\begin{frame}{Showing the work}{Now that we know $s$}

\TwoColumns{%
\begin{center}
    \begin{tabular}{ccc}
    $w$ & \And{w}{s} & \DotP{w}{s} \\ \hline
        \G{0000}{0000}{0} \\
        \G{0001}{0000}{0} \\
        \B{0010}{0010}{1} \\
        \B{0011}{0010}{1} \\
        \G{0100}{0000}{0} \\
        \G{0101}{0000}{0} \\
        \B{0110}{0010}{1} \\
        \B{0111}{0010}{1}
    \end{tabular}
\end{center}
}{%
\begin{center}
    \begin{tabular}{ccc}
    $w$ & \And{w}{s} & \DotP{w}{s} \\ \hline
        \B{1000}{1000}{1} \\
        \B{1001}{1000}{1} \\
        \G{1010}{1010}{0} \\
        \G{1011}{1010}{0} \\
        \B{1100}{1000}{1} \\
        \B{1101}{1000}{1} \\
        \G{1110}{1010}{0} \\
        \G{1111}{1010}{0}
    \end{tabular}
\end{center}
}%
\BigSkip{}
\visible<2->{These are the values of $w$ we might observe.}


\end{frame}
}

\begin{frame}{How many equations do we need?}{One fewer than we think}

\begin{itemize}[<+->]
    \item Normally for $n$ unknowns we need $n$~equations to find the unique solution.
    \item In our two examples so far, we needed only $n-1$ equations. One more equation only confirmed the solution that $n-1$ linearly independent equations already provided.
    \item Was this a fluke or is this generally true for Simon's problem?
    \item We take note that there is always a solution to an instance of Simon's problem where $s$ is all zeros.  
    \item While that solution is trivial albeit unacceptable to us, linear algebra tells us we just need $n-1$ equations to find the two solutions.
\end{itemize}
    
\end{frame}

\begin{frame}{Simon's algorithm}{A summary of what we know so that we can perform some analysis}

\begin{enumerate}
    \item Create the quantum circuit we have shown for an instance of this problem.  The oracle is engineered as we have shown previously so that it places the correct values on the output qubits for all basis states.
    \item\label{step:doover} Run that circuit $n-1$ times to obtain observations $w_{1}, w_{2}, \ldots, w_{n-1}$.  These for the rows of a matrix.
    \item Determine if those rows are linearly independent and that none of them is all zeros.
    \begin{itemize}
        \item If they are, then use Gaussian elimination to find the secret~$s$.
        \item If they are not, start over at step~\ref{step:doover}.
    \end{itemize}
\end{enumerate}
\begin{itemize}
    \item<2-> To succeed we must be able to run Gaussian elimination on $n-1$ independent rows, none of which is all zeros.
    \item<3-> What is the probability that we obtain a suitable matrix in a given iteration of the above algorithm?  \alert{TL;DR? at least $\frac{1}{4}$}
\end{itemize}
\end{frame}
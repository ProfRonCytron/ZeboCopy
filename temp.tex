\SetTitle{99}{temp}{faster}{99}





\begin{frame}{On the nature of a universal set of gates}{Some thoughts \LinkArrow{https://www.scottaaronson.com/qclec/16.pdf}}

\Vskip{-2em}Using \href{https://www.youtube.com/watch?v=LVIaZSYLwtE}{calculatus eliminatus} we first considers sets of gates that \emph{cannot} work:
\begin{description}
\item<1->[no superposition]  The gate set \Set{\NamedGate{CNOT}} cannot create superposition on its own.  \only<1>{It maps basis states to other basis states, but cannot introduce superposition where there was none before. \begin{center}\CNOTMatrix\end{center}}
\item<2->[no entanglement]  The set \Set{\Hadamard} creates superpositions, but not entanglement.\only<2>{  Any gate that operates only a single qubit cannot create entanglement.}
\item<3->[no phasing]  \Set{\NamedGate{CNOT},\Hadamard} cannot introduce phase.\only<3>{ These gates create superpositions and entanglement, but given real inputs they can create only real outputs. A gate must be able to create \emph{complex outputs} from real inputs to introduce phase.}
\item<4->[the \emph{stabilizer} gates] \Set{\NamedGate{CNOT},\Hadamard,\NamedGate{S}}, where $\NamedGate{S}=\SQBG{}{1}{0}{0}{\NiceI}$.  This  set includes the \href{https://en.wikipedia.org/wiki/Quantum_logic_gate\#Phase_shift_gates}{phase gate} \NamedGate{S}, so it has none of the above deficiencies, but it is not universal.  \only<4>{The \href{https://en.wikipedia.org/wiki/Gottesman\%E2\%80\%93Knill_theorem}{Gottesman--Knill theorem} proves that circuits comprised of these gates can be simulated classically in polynomial time, so they cannot capture problems for which quantum gives exponential speedup over classical computing.  We study this later.}

\end{description}

\end{frame}

\begin{frame}{Towards a universal gate set}{What are our concerns?}
\begin{description}
  \item[size] How many inputs must a quantum gate accept?
  \only<1>{%
\begin{itemize}
    \item Consider a unitary transformation on $n$ qubits, where arbitrary entanglement might be a pre- or post-condition of the transformation.
    \item Must we realize this using a gate that handles $n$~qubits?
    \item As a classical version of this problem, consider computing a function of $n$~bits that is true if and only if all the $n$~bits are true: $\mbox{And}\left(q_{1},  q_{2}, \ldots, q_{n}\right)$.
    \item We might think that this operation must take in all the bits to produce an answer, but we know we can break this down into operations involving only two bits at a time.
\end{itemize}}
  \item[accuracy] How closely can we approximate a quantum computation?
  \only<2>{%
  \begin{itemize}
      \item Quantum systems (states and gates) can be specified using irrational constants.
      \item The number of such components is thus uncountably infinite.
      \item We necessarily approximate the behavior of such systems.
      \item How well do measurements of a finite quantum system approximate measurements of its ideal system?
      \item As a classical version of this problem, consider decisions based on real arithmetic
      \item On a computer this is carried out in (finite) floating-point.  How does that approximation affect decisions?
  \end{itemize}}
\end{description}
\end{frame}
{
\def\CC{\alt<3->{$\textcolor<5>{\RCone}{0}$}{\CFCirc{\RCone}}}
\def\CDa{\alt<3->{\alt<7->{\CFCirc{\RCthree}}{\CFCirc{\RCfive}}}{\CFCirc{\RCone}}}
\def\CDb{\alt<3->{\alt<7->{\CFCirc{\RCfour}}{\CFCirc{\RCfive}}}{\CFCirc{\RCone}}}
\def\CDc{\alt<3->{\alt<8->{\CFCirc{\RCone}}{\CFCirc{\RCfive}}}{\CFCirc{\RCone}}}
\def\CDd{\alt<3->{\alt<8->{\CFCirc{\RCtwo}}{\CFCirc{\RCfive}}}{\CFCirc{\RCone}}}
\def\CE{\alt<3->{$\textcolor<5>{\RCone}{1}$}{\CFCirc{\RCone}}}
\def\CCRVDots{\textcolor<5>{\RCone}{\RVDots}}
\begin{frame}{Two-level quantum systems}{These affect (under control) only a single qubit}

\TwoUnequalColumns{0.63\textwidth}{0.37\textwidth}{%
\only<1-4>{%
\begin{itemize}
    \item<1-> We begin with a quantum gate for an~$n$~qubit system.
    \item<2-> Conceptually this can be viewed as a~$2^{n}\times2^{n}$ matrix~$U$.
    \item<3-> We apply transformations to $U$, each of which affects only a single qubit at a time, to reduce $U$ \ColorFive{to a form} where it also affects only a single qubit.
    \item<4-> The matrix is \emph{not} necessarily tensor-factorable (the \NamedGate{CNOT} gate is an example), so in what sense does it affect only a single qubit?
\end{itemize}}%
\only<5-8>{%
\Vskip{-3em}\begin{itemize}
    \item<5-> For all but two basis states, \ColorOne{$U$ acts as the identity matrix}.
    \item<6-> However, the matrix \ColorFive{can act differently on basis states~\ket{\TensSupProd{1}{n-1}0} and \ket{\TensSupProd{1}{n-1}1}}:
    \visible<7->{\begin{align*}
U\ket{\TensSupProd{1}{n-1}0} = &\CFCirc{\RCthree}\ket{\TensSupProd{1}{n-1}0} + \CFCirc{\RCfour}\ket{\TensSupProd{1}{n-1}1} \\
   = &\TensProd{\TensSupProd{1}{n-1}}{\left(\CFCirc{\RCthree}\QZero{} + \CFCirc{\RCfour}\QOne{}\right)}
  \end{align*}}
  \visible<8->{\Vskip{-3em}\begin{align*}
U\ket{\TensSupProd{1}{n-1}1} = &\CFCirc{\RCone}\ket{\TensSupProd{1}{n-1}0} + \CFCirc{\RCtwo}\ket{\TensSupProd{1}{n-1}1} \\
   = &\TensProd{\TensSupProd{1}{n-1}}{\left(\CFCirc{\RCone}\QZero{} + \CFCirc{\RCtwo}\QOne{}\right)}
  \end{align*}}
    
\end{itemize}
}%
\only<9->{%
\Vskip{-3em}\begin{itemize}
    \item<9-> Thus, when the input's left $n-1$ bits are all~$1$, we can act on the rightmost bit applying the unitary gate $U=\SQBG{\relax}{\CFCirc{\RCthree}}{\CFCirc{\RCone}}{\CFCirc{\RCfour}}{\CFCirc{\RCtwo}}$.
    \item<10-> This is a \emph{conditional} gate and can be represented by the circuit:
\end{itemize}
    \visible<10->{\begin{center}\adjustbox{scale=0.8,valign=t}{%
\begin{quantikz}
    \lstick{$q_1$} & \qw & \ctrl{1} & \qw \\
    \lstick{$q_2$} & \qw & \ctrl{1} & \qw \\
    \lstick{$\RVDots$} & \qw  & \ctrl{1} & \qw \\
    \lstick{$q_{n-1}$} & \qw & \ctrl{1} & \qw \\
    \lstick{$q_n$} & \qw & \gate{U} & \qw
\end{quantikz}}\end{center}}
}
}{%
\Vskip{-4em}
\[2^{n}\begin{pmatrix*}
 \CE & \CC &  \CC & \cdots& \CC & \CC \\
 \CC & \CE &  \CC & \cdots& \CC & \CC \\
 \CC & \CC &  \CE & \cdots& \CC & \CC \\
 \CCRVDots & \CCRVDots & \CCRVDots  & \CCRVDots & \CCRVDots  & \CCRVDots\\
 \CC & \CC &  \CC & \cdots& \CDa & \CDc \\
 \CC & \CC & \CC & \cdots& \CDb & \CDd
\end{pmatrix*}\]
\only<11>{%
In terms of basis states, this circuit acts as identity \emph{unless} qubits $q_1, \ldots, q_{n-1}$ are all~$1$, in which case $U$ is applied to $q_{n}$.  This is exactly the behavior specified by the above matrix.
}%
\only<12>{%
\SmallSkip{}We must show that we can implement \NamedGate{C\mbox{$\,^{n-1}$}U} using only \NamedGate{CCNOT}~gates, extra qubits, and a  controlled-\NamedGate{U} gate. This will be an exercise.}%
}
\end{frame}}

\begin{frame}{Generalizing to other qubits}{For now they differ only in one position}

\Vskip{-4em}\TwoUnequalColumns{0.65\textwidth}{0.35\textwidth}{%
\only<1-3>{%
\begin{itemize}
    \item<1-> The example from the previous slide requires qubits $q_{1},q_{2},\ldots,q_{n-1}$ to be~$1$ to activate $U$.
    \item<2-> We want to generalize this in two ways:
    \begin{enumerate}
        \item We wish to move $U$ to act on a qubit other than the bottom one, such as $q_i$.
        \item We wish to activate $U$ on any arbitrary bit pattern of the other qubits.
    \end{enumerate}
\end{itemize}
\only<3>{%
\begin{itemize}
 \item<3-> The first generalization is easily accomplished by redrawing the diagram, controlling $U$ from any of the other $n-1$ qubits.  We could also use a \href{https://en.wikipedia.org/wiki/Quantum_logic_gate\#Swap_gate}{swap gate} if $U$ were physically restricted to acting only on the bottom qubit.
 \item<3-> When all other qubits are~$1$, gate $U$ acts on~$q_i$.
\end{itemize}}}
\only<4->{%
\begin{itemize}
    \item<4-> How do we activate $U$ on a bit pattern other than all-$1$s?
    \item<5-> If we want $q_n$ to be~$0$ instead of~$1$, we need only compliment it prior and after the $U$ gate, as shown here.
    \item<6-> A shorthand for this is to use an open circle on such control bits, as shown here.
    \item<7-> $U$ is now activated on $q_i$ when 
    \begin{itemize}
        \item $q_{1}, q_{2},\ldots,q_{i-1}, q_{i+1},\ldots,q_{n-1}$ are~$1$
        \item $q_n$ is~$0$.
    \end{itemize}
    \item<8-> We can apply this idea to any of the qubits to trigger $U$ exactly when desired.
\end{itemize}
}
}{%
\only<1-2>{%
\begin{center}\adjustbox{scale=0.8,valign=t}{%
\begin{quantikz}
    \lstick{$q_1$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$q_2$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$\RVDots$} & \qw  & \ctrl{1} & \qw & \qw\\
    \lstick{$q_i$}  & \qw & \ctrl{1} & \qw & \qw\\
     \lstick{$\RVDots$} & \qw  & \ctrl{1} & \qw& \qw \\
    \lstick{$q_{n-1}$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$q_n$} & \qw & \gate{U} & \qw& \qw
\end{quantikz}}\end{center}}
\only<3-4>{%
\begin{center}\adjustbox{scale=0.8,valign=t}{%
\begin{quantikz}
    \lstick{$q_1$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$q_2$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$\RVDots$} & \qw  & \ctrl{1} & \qw & \qw\\
    \lstick{$q_i$}  & \qw & \gate{U} & \qw & \qw\\
     \lstick{$\RVDots$} & \qw  & \ctrl{-1} & \qw& \qw \\
    \lstick{$q_{n-1}$} & \qw & \ctrl{-1} & \qw & \qw\\
    \lstick{$q_n$} & \qw & \ctrl{-1} & \qw& \qw
\end{quantikz}}\end{center}}
\only<5>{%
\begin{center}\adjustbox{scale=0.8,valign=t}{%
\begin{quantikz}
    \lstick{$q_1$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$q_2$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$\RVDots$} & \qw  & \ctrl{1} & \qw & \qw\\
    \lstick{$q_i$}  & \qw & \gate{U} & \qw & \qw\\
     \lstick{$\RVDots$} & \qw  & \ctrl{-1} & \qw & \qw\\
    \lstick{$q_{n-1}$} & \qw & \ctrl{-1} & \qw & \qw\\
    \lstick{\alert<5>{$q_n$}} & \gate{\alert<5>{X}} & \ctrl{-1} & \gate{\alert<5>{X}}& \qw
\end{quantikz}}\end{center}}
\only<6->{%
\begin{center}\adjustbox{scale=0.8,valign=t}{%
\begin{quantikz}
    \lstick{$q_1$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$q_2$} & \qw & \ctrl{1} & \qw & \qw\\
    \lstick{$\RVDots$} & \qw  & \ctrl{1} & \qw & \qw\\
    \lstick{$q_i$}  & \qw & \gate{U} & \qw & \qw\\
     \lstick{$\RVDots$} & \qw  & \ctrl{-1} & \qw & \qw\\
    \lstick{$q_{n-1}$} & \qw & \ctrl{-1} & \qw & \qw\\
    \lstick{\alert<6>{$q_n$}} & \qw & \octrl{-1} & \qw& \qw
\end{quantikz}}\end{center}}
}

    
\end{frame}

{
\def\C#1{\makebox[1.5ex]{\hss #1\hss}}
\def\CN{\C{$1$}}
\def\CZ{\C{$0$}}
\def\CI{\textcolor<3-8>{\RCone}{\C{$0$}}}
\def\CII{\alt<5->{\C{\CFCirc{\RCone}}}{\textcolor<3->{\RCone}{\C{$1$}}}}
\def\CJ{\textcolor<4-8>{\RCtwo}{\C{$0$}}}
\def\CJJ{\alt<8->{\C{\CFCirc{\RCtwo}}}{\textcolor<4->{\RCtwo}{\C{$1$}}}}
\def\CIJ{\alt<6->{\C{\CFCirc{\RCthree}}}{\alt<1-2>{\C{$0$}}{\alt<3>{\ColorOne{\C{$0$}}}{\ColorFive{\C{$0$}}}}}}
\def\CJI{\alt<7->{\C{\CFCirc{\RCfour}}}{\alt<1-2>{\C{$0$}}{\alt<3>{\ColorOne{\C{$0$}}}{\ColorFive{\C{$0$}}}}}}
\begin{frame}{Two-level matrices}{Definition}

\TwoColumns{%
\only<1-9>{
\begin{itemize}[<+->]
    \item A \emph{two-level unitary matrix} is a matrix that acts nontrivially on two-or-fewer vector components~(\MikeIke{}).
    \item To obtain such a matrix, initialize $M$ to the identity matrix.
    \item Pick matrix index \ColorOne{$i$}. Here, $\ColorOne{i}=2$.
    \item WLOG pick matrix index $\ColorTwo{j}, \ColorTwo{j}>\ColorOne{i}$.  Here, $\ColorTwo{j}=5$.
    \item Replace entries $\ColorOne{m_{ii}}\visible<6->{, \ColorThree{m_{ij}}}\visible<7->{, \ColorFour{m_{ji}}}\visible<8->{, \ColorTwo{m_{jj}}}$ with any values that preserve unitarity.
\end{itemize}}
\only<10->{%
\begin{itemize}
    \item<10-> $\Prob{\CFCirc{\RCone}} + \Prob{\CFCirc{\RCthree}}=1$
    \item<11-> $\Prob{\CFCirc{\RCfour}} + \Prob{\CFCirc{\RCtwo}}=1$
    \item<12-> $\Prob{\CFCirc{\RCone}} + \Prob{\CFCirc{\RCfour}}=1$
    \item<13-> $\Prob{\CFCirc{\RCthree}} + \Prob{\CFCirc{\RCtwo}}=1$
    \item<14-> The columns form an orthonormal basis: $\Conj{M}M=\Identity{}$
    \item<15-> The rows form an orthonormal basis: $M\Conj{M}=\Identity{}$
\end{itemize}}
}{%
\[
\begin{pmatrix*}
\CN & \CI & \CZ & \CZ & \CJ & \CZ & \CZ & \CZ \\
\CI & \CII & \CI & \CI & \CIJ & \CI & \CI & \CI \\
\CZ & \CI & \CN & \CZ & \CJ & \CZ & \CZ & \CZ \\
\CZ & \CI & \CZ & \CN & \CJ & \CZ & \CZ & \CZ \\
\CJ & \CJI & \CJ & \CJ & \CJJ & \CJ & \CJ & \CJ \\
\CZ & \CI & \CZ & \CZ & \CJ & \CN & \CZ & \CZ \\
\CZ & \CI & \CZ & \CZ & \CJ & \CZ & \CN & \CZ \\
\CZ & \CI & \CZ & \CZ & \CJ & \CZ & \CZ & \CN 
\end{pmatrix*}\]%
\visible<9->{%
\SmallSkip{}
Any such matrix is a two-level unitary matrix.  Unitarity significantly constrains the possibilities for the four values.}
}
    
\end{frame}}

{
\def\C#1{\makebox[1.5ex]{\hss #1\hss}}
\def\CR{\C{\CFCirc{\RCone}}}
\def\CZ#1{\alt<#1->{\C{$0$}}{\CR}}
\def\CG#1{\alt<#1->{\C{\ColorThree{$0$}}}{\CR}}
\def\CN#1{\alt<#1->{\C{\ColorTwo{$1$}}}{\CR}}
\begin{frame}{Obtaining two-level matrices}{Series of transformations to obtain the desired form}

\Vskip{-4em}\TwoUnequalColumns{0.5\textwidth}{0.5\textwidth}{%
\begin{itemize}
    \item<1-> We begin with a unitary matrix.
    \item<2-> We find unitary, two-level $U_{1}$ so that $U_{1}U$ has a~$0$ as shown.
    \item<3-> We find unitary, two-level $U_{2}$ so that $U_{2}U_{1}U$ is as shown.
    \item<4-> We continue down the column.
    \item<5-> Unitarity guarantees this \ColorTwo{1}.
    \item<6-> Unitarity guarantees these \ColorThree{0} entries.
    \item<7-> We then recursively apply this procedure to the \ColorOne{submatrix}.
\end{itemize}
}{%
\[
\visible<4->{U_{7}U_{6}U_{5}U_{4}U_{3}}\visible<3->{U_2}\visible<2->{U_1}U =
\]
\[
\begin{pmatrix*}
\CN{5} & \CG{6} & \CG{6} & \CG{6} & \CG{6} & \CG{6} & \CG{6} & \CG{6} \\
\CZ{2} & \CR & \CR & \CR & \CR & \CR & \CR & \CR \\
\CZ{3} & \CR & \CR & \CR & \CR & \CR & \CR & \CR \\
\CZ{4} & \CR & \CR & \CR & \CR & \CR & \CR & \CR \\
\CZ{4} & \CR & \CR & \CR & \CR & \CR & \CR & \CR \\
\CZ{4} & \CR & \CR & \CR & \CR & \CR & \CR & \CR \\
\CZ{4} & \CR & \CR & \CR & \CR & \CR & \CR & \CR \\
\CZ{4} & \CR & \CR & \CR & \CR & \CR & \CR & \CR 
\end{pmatrix*}\]
}
    
\end{frame}}


{
\def\I{\NiceI}
\def\A#1{\ColorOne{\ensuremath{#1}}}
\def\B#1{\ColorTwo{\ensuremath{#1}}}
\def\R#1{\ColorFive{\ensuremath{#1}}}
\def\C#1{\ColorThree{\ensuremath{#1}}}
\def\D#1{\ColorFour{\ensuremath{#1}}}
\begin{frame}{Worked example}{From \MikeIke{} Exercise 4.37}
\TwoColumns{%
}{%
\begin{align*}
    U = \frac{1}{2}\begin{pmatrix*}[r]
    \A{1} & \C{1} & 1 & 1 \\
    \B{1} & \D{\I} & -1 & -\I \\
    1 & -1 & 1 & -1 \\
    1 & -\I & -1 & \I
    \end{pmatrix*}
\end{align*}}
\SmallSkip{}We develop a two-level unitary matrix $U_1$ based on the highlighted entries so that $U_{1}U$ has zero in the \ColorTwo{lower left} entry.  Throughout, we name the values we need:
\begin{description}
   \item[\A{a}] is \ColorOne{this} value
   \item[\B{b}] is \ColorTwo{this} value
   \item[\R{r}] is a scaling factor computed as
   \( \sqrt{\Prob{\A{a}} + \Prob{\B{b}}} \)
\end{description}

\end{frame}}

\documentclass[aspectratio=169,t,13pt,usenames,dvipsnames]{beamer}
\usetheme[lily]{PaloAlto}
\usecolortheme{dolphin}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{tikz-3dplot}
\usepackage{adjustbox}
\usetikzlibrary{quantikz}
\usepackage{xcolor}
\pgfplotsset{compat=newest}
\logo{%
\stackbox[c][c]{\includegraphics[height=1.15cm]{logo.pdf}\\[-3pt]{\textcopyright~2021}\\{Ron K. Cytron}}}

% \logo{\includegraphics[height=2.5cm]{logo.pdf}}
\def\ColorR#1{\textcolor{BrickRed}{#1}}
\def\ColorG#1{\textcolor{OliveGreen}{#1}}
\def\ColorB#1{\textcolor{NavyBlue}{#1}}
\definecolor{links}{HTML}{2E8B57}
\hypersetup{colorlinks,linkcolor=,urlcolor=links}
\def\LinkArrow#1{%
\mbox{$\,$\href{#1}{\mbox{\vrule width 0pt height 0ex depth 0pt$\mapsto$}}}$\,$}
\def\True{\mbox{\texttt{True}}}
\def\False{\mbox{\texttt{False}}}
\def\Zero{\mbox{$0$}}
\def\One{\mbox{$1$}}
\def\Not#1{%
\ensuremath{\Overline{#1}}}
\def\Xor#1#2{\ensuremath{#1\oplus #2}}
\def\Nand#1#2{%
\ensuremath{\mbox{Nand}(#1,#2)}}
\def\And#1#2{%
\ensuremath{#1 \wedge #2}}
\def\Or#1#2{%
\ensuremath{#1 \vee #2}}
\def\Conj#1{%
\ensuremath{#1^{\star}}}
\def\Star#1{%
\Conj{#1}}
\def\EmptyString{\ensuremath{\lambda}}
\def\Mag#1{%
\ensuremath{|\,#1\,|}}
\def\Prob#1{%
\ensuremath{\Mag{#1}^{2}}}
\def\CNOT#1#2{%
\ensuremath{\NamedGate{CNOT}(#1,#2)}}
\def\CNOTMatrix{%
\begin{pmatrix*}[r]
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 1 & 0\end{pmatrix*}%
}
\def\CCNOT#1#2#3{%
\ensuremath{\mbox{CNOT}(#1,#2,#3)}}
\long\def\ToDo#1{\smash{\textcolor{YellowOrange}{#1}}}
\def\ApplyGate#1#2{%
\ensuremath{#1\,#2}}
\def\Inverse#1{\ensuremath{{#1}^{-1}}}
\def\Quote#1{``#1''}
\def\NamedGate#1{%
\mbox{\bfseries{\textrm{#1}}}}
\def\Identity{\NamedGate{I}}
\def\Hadamard{\NamedGate{H}}
\def\PauliX{\NamedGate{X}}
\def\PauliY{\NamedGate{Y}}
\def\PauliZ{\NamedGate{Z}}
\def\SQBG#1#2#3#4#5{%
\ensuremath{%
#1 \begin{pmatrix*}[r] #2 & #3 \\ #4 & #5\end{pmatrix*}}}
\def\HMatrix{%
\SQBG{\RootTwo{}}{1}{1}{1}{-1}}
\def\XMatrix{%
\SQBG{\relax}{0}{1}{1}{0}}
\def\ZMatrix{%
\SQBG{\relax}{1}{0}{0}{-1}}
\def\YMatrix{%
\SQBG{\relax}{0}{-i}{i}{0}}
\def\Co#1{\mathbb{C}}
\def\Implies#1#2{\ensuremath{#1 \rightarrow\ #2}}
\def\Domain#1{\ensuremath{\mathcal{#1}}}
\def\CompClass#1{\Domain{#1}}
\def\SpecialX#1{\ensuremath{#1^{\star}}}
\def\Forall#1#2{\ensuremath{\forall\ #1, #2}}
\def\Degrees#1{\ensuremath{#1^{\circ}}}
\def\RootTwo{\ensuremath{\frac{1}{\sqrt{2}}}}
\def\Set#1{\ensuremath{\left\{\,#1\,\right\}}}
\def\BigSkip{%

\bigskip

}

\def\MedSkip{%

\medskip

}
\def\SmallSkip{%

\smallskip

}
\def\SineWave#1{%
{%
\pgfmathsetmacro{\Xone}{#1}
\pgfmathsetmacro{\Xtwo}{-(#1)}
\draw (0,0) sin(1,\Xone) cos (2,0) sin(3,\Xtwo) cos (4,0);
}
}
\newcommand{\tolstrut}{%
  \vrule height\dimexpr\fontcharht\font`\A+.1ex\relax width 0pt\relax
}

\DeclareRobustCommand{\Overline}[1]{%
  \ensuremath{\overline{\raisebox{0pt}[1.07\height]{#1}}}%
}
\newenvironment{TIKZP}[1][scale=1.0]{%
\adjustbox{valign=t}\bgroup
\begin{tikzpicture}[#1]
}{%
\end{tikzpicture}
\egroup
}
\long\def\Definition#1{%
\begin{block}{Definition}
#1
\end{block}}
\long\def\Postulate#1#2{%
\begin{block}{Postulate}
\begin{description} \item[#1] #2\end{description}
\end{block}}
\long\def\TwoUnequalColumns#1#2#3#4{%
\begin{columns}%
\begin{column}{#1}#3\end{column}%
\begin{column}{#2}#4\end{column}%
\end{columns}%
}
\long\def\ThreeUnequalColumns#1#2#3#4#5#6{%
\begin{columns}%
\begin{column}{#1}#4\end{column}%
\begin{column}{#2}#5\end{column}%
\begin{column}{#3}#6\end{column}%
\end{columns}%
}
\long\def\ThreeColumns#1#2#3{%
\ThreeUnequalColumns{0.33\textwidth}{0.33\textwidth}{0.33\textwidth}{#1}{#2}{#3}%
}
\long\def\TwoColumns#1#2{%
\TwoUnequalColumns{0.5\textwidth}{0.5\textwidth}{#1}{#2}%
}
\long\def\OnlyRemark#1#2{%
\only<#1>{\Remark{#2}}}

\long\def\Remark#1{%
\begin{block}{Remark}
#1
\end{block}}
\long\def\Example#1{%
\begin{example} #1\end{example}}
\def\VV{\textit{vice versa}}
\def\QZero{\ket{0}}
\def\QOne{\ket{1}}
\def\QState#1{\ket{\QName{#1}}}
\def\QName#1{\ensuremath{\psi_{#1}}}
\def\TensProd#1#2{\ensuremath{#1\otimes #2}}
\def\TensSupProd#1#2{\ensuremath{#1^{\otimes #2}}}
\def\PZero{\SQB{1}{0}}
\def\POne{\SQB{0}{1}}
\def\PHad{\ensuremath\frac{1}{\sqrt{2}}\SQB{1}{1}}
\def\RootTwo{\ensuremath{\frac{1}{\sqrt{2}}}}
\def\Intersect#1#2{\ensuremath{#1 \cap #2}}
\def\Union#1#2{\ensuremath{#1 \cup #2}}
\def\Set#1{\ensuremath{\left\{\,#1\,\right\}}}
\def\AllBits#1#2{\ensuremath{#1\in \Set{0,1}^{#2}}}
\def\DQB#1#2#3#4{%
\ensuremath{\begin{pmatrix*}[r] #1 \\ #2 \\ #3 \\ #4\end{pmatrix*}}}
\def\QQB#1#2#3#4#5#6#7#8{%
\ensuremath{\begin{pmatrix*}[r] #1 \\ #2 \\ #3 \\ #4 \\ #5 \\ #6 \\ #7 \\ #8\end{pmatrix*}}}
\def\SQB#1#2{%
\ensuremath{\begin{pmatrix*}[r] #1 \\ #2\end{pmatrix*}}}
\def\CQB#1#2{%
\ensuremath{\begin{pmatrix*}[r] #1 #2\end{pmatrix*}}}
\def\TZPointDiam{2pt}
\def\TZPoint#1#2#3{%
\draw[fill=black] (#1) circle (\TZPointDiam) node[#3] {#2} ;}
\def\UnitComplexCircle{%
\draw [<->] (-1.5, 0) -- (1.5, 0)  node[right] {$\Re{}$} ;
   \draw [<->] (0,-1.5) -- (0, 1.5) node[above] {$\Im{}$} ;

   \draw (0, 0) circle (1) ;
   }
   \def\TZPEast{\TZPoint{1,0}{$+1$}{above right}}
   \def\TZPNorth{\TZPoint{0,1}{$i$}{above right}}
   \def\TZPWest{\TZPoint{-1,0}{$-1$}{above left}}
   \def\TZPSouth{\TZPoint{0,-1}{$-i$}{below right}}
\def\TZText#1#2#3{%
  \draw (#1) node [#3] {#2};
}
\def\Qiskit{\texttt{qiskit}}
\def\TwoToThe#1{\ensuremath{2^{#1}}}
\def\Exp#1{\ensuremath{e^{#1}}}
\def\ExpPhase#1{\Exp{i\,#1}}
\def\ExpNegPhase#1{\Exp{-i\,#1}}
%%
%% Not sure this is used
%%
\def\PhaseLabel#1{\phase{\fbox{#1}}}
%%
\def\ColHead#1{\begin{center}\bf #1\end{center}}
\def\Complex#1#2{\ComplexGen{#1}{#2}{+}}
\def\ComplexDiff#1#2{\ComplexGen{#1}{#2}{-}}
\def\ImaginaryM#1{\ComplexDiff{\relax}{#1}}
\def\ComplexGen#1#2#3{%
\ensuremath{#1 #3 i\relax #2}}
\def\Polar#1#2{\ensuremath{#1\hbox to 0.1pt{\hss}\Exp{i\relax#2}}}
%%
%% #1 -- lower left x
%% #2 -- lower left y
%% #3 -- upper right x
%% #4 -- upper right y
%% #5 -- num lines
\def\PFilter#1#2#3#4#5{

    \draw (#1,#2) -- (#3,#2) -- (#3,#4) -- (#1,#4) -- cycle;
    \foreach \i in {1,...,#5}
    {
        \pgfmathsetmacro{\PFilterInc}{#1 + (#3-#1) / #5 * \i}
        % \edef\PFilterInc{\pgfmathresult}
        \draw (\PFilterInc, #2) -- (\PFilterInc, #4);
    }
}
%% #1 - x
%% #2 - y
%% #3 - degrees
%% #4 - options
%% #5 - radius
\def\RadiantArrowsR#1#2#3{%
\foreach \p in {0, #1,...,360} {
   \draw[#2] (0,0)  -- (\p:#3) ;
}
}
\def\RadiantArrows#1#2{%
   \RadiantArrowsR{#1}{#2}{1}
}
\newcommand\RotateTheta[1][scale=1.0]{%
\SquareOutline{}
\begin{scope}[#1]
\fill[white] (0.5,0.5) circle (0.5);
\draw (0.5,0.5) circle (0.5);
\draw[->] (1.0,0.5) arc(0:45:0.5);
\draw (0.5,0.5) node {$\theta$};
\end{scope}
}
\def\SquareOutline{%
\path (0,0) rectangle (1,1);
}
\newcommand\Qif[1][scale=1.0]{%
\begin{scope}[#1]
\SquareOutline{}
\clip (0,0) rectangle(1,1);
\RotateAroundCenter{45}{%
\begin{scope}
\draw (0.15,0.15) rectangle(0.85,0.85);
\end{scope}}
\end{scope}
}
\newcommand\LightSource[1][scale=1.0]{%
\begin{scope}[#1]
\SquareOutline{}
\PhotonGun{}
\begin{scope}[shift={(0.75,0.5)}]
    \RadiantArrowsR{22.5}{color=red}{0.25}
\end{scope}
\end{scope}
}
\def\PhotonGun{%
\fill (0,0.375) rectangle (0.5, 0.625);
}
\def\HPolar{%
\begin{scope}[color=red]
\SquareOutline{}
\draw[thick] (0.5,0.4) -- ++(0.35,0)
             ++(-0.35,0.1) -- ++(0.35,0)
             ++(-0.35,0.1) -- ++(0.35,0);
% \fill (0.90,0.5) circle (0.05);
\end{scope}
}
\def\VPolar{%
\begin{scope}[color=red]
\draw[thick] (0.6,0.375) -- ++(0,.250)
             ++(0.1,-.250) -- ++(0,.250)
             ++(0.1,-.250) -- ++(0,.250);
% \fill (0.95,0.5) circle (0.05);
\end{scope}
}
\newcommand\HPolarizedLightSource[1][scale=1.0]{%
\begin{scope}[#1]
\SquareOutline{}
\PhotonGun{}
\HPolar{}
\end{scope}
}
\newcommand\VPolarizedLightSource[1][scale=1.0]{%
\begin{scope}[#1]
\SquareOutline{}
\PhotonGun{}
\VPolar{}
\end{scope}
}
\newcommand\EVBomb[1][scale=1.0]{%
\begin{scope}[#1]
\fill (0.5,0.5) circle(0.5);
\end{scope}%
}
\newcommand\EVBoom[1][scale=1.0]{%
\begin{scope}[#1]
\fill[white] (0.5,0.5) circle(0.5);
\draw[red,thick] (0.5,0.5) circle(0.5);
\clip (0,0) rectangle(1,1);
\begin{scope}
\node[scale=0.35,xshift=28pt,yshift=28pt,starburst,draw,red,fill=orange,line width=1.5pt]
{BOOM!};
\end{scope}
\end{scope}
}
\newcommand\Measurement[1][scale=1.0]{%
\begin{scope}[#1]
\draw[color=white] (0,0) rectangle(1,1);
\begin{scope}
\clip (0.25,0.25) rectangle (1,1);
\draw (0,0) circle(0.9);
\draw (0,0) circle(1.0);
\end{scope}
\draw[thick] (0,0) --(0,1);
\draw[->] (0.25,0.25) -- (0.9,0.9);
\end{scope}
}
\def\TRectangle#1#2#3#4#5#6{%
\begin{scope}[#6]
\draw [fill=#5] (#1,#2) rectangle (#3,#4);
\end{scope}
}
%% #1 -- llx
%% #2 -- lly
%% #3 -- urx
%% #4 -- ury
%% #5 -- angle
\newcommand\Mirror[1][rotate=0]{%
\clip (0,0) rectangle(1,1);
\begin{scope}[#1]
   \SquareOutline{}
   \TRectangle{0}{.4375}{1}{.5625}{Gray}{rotate=0}
\end{scope}
}
\newcommand\BeamSplitter[1][scale=1.0]{%
\begin{scope}[#1]
    \SquareOutline{}
    \TRectangle{0}{.375}{1}{.625}{SkyBlue}{rotate=0}
\end{scope}
}
\def\MZ{%
\LightSource{}
\Shift{2}{0}{\RotateAroundCenter{-45}{\BeamSplitter{}}}
\Shift{2}{-2}{\RotateAroundCenter{-45}{\Mirror{}}}
\Shift{6}{0}{\RotateAroundCenter{-45}{\Mirror{}}}
\Shift{6}{-2}{\RotateAroundCenter{-45}{\BeamSplitter{}}}
\Shift{8}{-2}{\Measurement[color=orange]{}}
\Shift{6}{-4}{\RotateAroundCenter{-90}{\Measurement[color=NavyBlue]{}}}
}
\def\Shift#1#2#3{%
\begin{scope}[shift={(#1,#2)}] #3\end{scope}
}
\def\RotateAroundCenter#1#2{%
\begin{scope}[rotate around={#1:(0.5,0.5)}]
  #2
\end{scope}
}
\def\Vskip#1{\mbox{}\vskip #1\mbox{}}
\def\Hskip#1{\mbox{}\hskip #1\mbox{}}
\author{Ron K.~Cytron}
\institute{Washington University\\Saint Louis, Missouri\\[2em] \textcopyright~2021 All rights reserved by the author}
\setbeamertemplate{footline}[frame number]{}
%\setbeamertemplate{footline}[text line]{%
%  \parbox{\linewidth}{\vspace*{-8pt}\textcopyright~2021\hfill\insertshortauthor\hfill\insertpagenumber}}
%% #1 -- lecture number
%% #2 -- lecture title
%% #3 -- lecture subtitle
%% #4 -- lecture label
\def\SetTitle#1#2#3#4{%
   \title{#2}%
   \subtitle{#3}%
   \date{\today}%
   %\begin{frame}\maketitle\end{frame}%
   \frame{\titlepage}%
   \lecture[#1]{#2: #3}{lec:#4}%
}
\def\Kaye{\href{https://dl.acm.org/doi/10.5555/1206629}{Kaye}}
\def\MikeIke{\href{https://dl.acm.org/doi/10.5555/1972505}{Nielson~and~Chuang}}

\newcounter{ProtocolDialogStep}
\newenvironment{ProtocolDialog}[3]{%
\def\Incr{\stepcounter{ProtocolDialogStep}}
\def\Ref##1{\Incr{}\ThreeUnequalColumns{#1}{#2}{#3}{\arabic{ProtocolDialogStep}. ##1}{\relax}{\relax}}%
\def\Alice##1{\Incr{}\ThreeUnequalColumns{#1}{#2}{#3}{\relax}{\arabic{ProtocolDialogStep}. ##1}{\relax}}%
\def\All##1##2##3{%
\Incr{}
\ThreeUnequalColumns{#1}{#2}{#3}{\arabic{ProtocolDialogStep}. ##1}{##2}{##3}
}
\def\Bob##1{\Incr{}\ThreeUnequalColumns{#1}{#2}{#3}{\relax}{\relax}{
\arabic{ProtocolDialogStep}. ##1}}%
\setcounter{ProtocolDialogStep}{0}%
\ThreeUnequalColumns{#1}{#2}{#3}{\textbf{Ref}}{\textbf{Alice}}{\textbf{Bob}}
}{%
}
%% #1 -- options
%% #2 -- width
%% #3 -- height
%% #4 -- signals
\newenvironment{GateBox}[4][scale=1.0]{%
\edef\Signals{#4}
\edef\Height{#3}
\edef\Width{#2}
\pgfmathsetmacro{\Max}{\Signals}
\pgfmathsetmacro{\Vsep}{\Height / \Max}
\pgfmathsetmacro{\Wlen}{\Width / 5}
\def\CalcY##1{%
0}
\def\Input##1##2{%
   \pgfmathsetmacro{\Xone}{-\Wlen}
   \pgfmathsetmacro{\Xtwo}{0}
   \pgfmathsetmacro{\MyY}{\Height - 0.5 * \Vsep - ##1*\Vsep}
   \draw[->] (\Xone,\MyY) node[left] {##2} -- (\Xtwo,\MyY);
}
\def\Output##1##2{%
   \pgfmathsetmacro{\Xone}{\Width}
   \pgfmathsetmacro{\Xtwo}{\Width + \Wlen}
   \pgfmathsetmacro{\MyY}{\Height - 0.5 * \Vsep - ##1*\Vsep}
   \draw[->] (\Xone,\MyY) -- (\Xtwo,\MyY) node[right] {##2};
}
\def\BoxLabel##1{%
\node[draw, fit={(0,0) (\Width,\Height)}, inner sep=0pt, label=center:\mbox{##1}] (A) {};
}
\begin{TIKZP}[#1]
   \draw (0,0) rectangle(#2,#3);
}{%
\end{TIKZP}
}
\def\PhiTheta#1#2{%
\mbox{\ensuremath{\textcolor{OrangeRed}{\phi = #1}, \textcolor{NavyBlue}{\theta = #2}}}}
\newenvironment{BlochSphere}[3][scale=1.0]{
    \bgroup%
    \def\BlochSpherePhiTheta{%
    \tdplotsetrotatedcoords{0}{0}{0};
        \path[tdplot_rotated_coords] (1.0,0,0) arc (0:115:1.0) node(phi) {};
        \draw[tdplot_rotated_coords,thick,OrangeRed] (0.3,0,0) arc (0:115:0.3);
        \draw[tdplot_rotated_coords,OrangeRed,thick,dashed] (0,0,0) -- (phi);
        \draw[OrangeRed] (0.4,0.4,0) node {$\phi$};
        
        \tdplotsetrotatedcoords{25}{-90}{0};
        \path[tdplot_rotated_coords] (1,0,0) arc (0:45:1) node(theta) {};
        \draw[tdplot_rotated_coords,thick,NavyBlue] (0.4,0,0) arc (0:45:0.4);
        \draw[tdplot_rotated_coords,NavyBlue,thick] (0,0,0) -- (theta);
        \draw[NavyBlue] (-0.4,0,0.3) node {$\theta$};
        
        
    }
    \def\TZPointDiam{0.7pt}%
    \def\ShowAxes{%
    \draw[dashed, tdplot_rotated_coords, black] (1,0,0) node {{\Large\bf x}} (0,1,0) node {{\Large\bf y}} (0,0,1) node {{\Large\bf z}};
    }%
    \tdplotsetmaincoords{#2}{#3}%
    \begin{tikzpicture}[tdplot_main_coords, #1]
        
        
        \shade[ball color = lightgray, opacity = 0.5] (0,0,0) circle (1cm);
        
        %%
        %% The equator
        %%
        \tdplotsetrotatedcoords{0}{0}{0};
        \draw[dashed, tdplot_rotated_coords, gray] (0,0,0) circle (1);
        
        %%
        %% Arc in the x-z plane
        %%
        \tdplotsetrotatedcoords{90}{90}{90};
        \draw[dashed, tdplot_rotated_coords, gray] (1,0,0) arc (0:180:1);
        
        %%
        %% Arc in the y-z plane
        %%
        \tdplotsetrotatedcoords{0}{90}{90};
        \draw[dashed, tdplot_rotated_coords, gray] (1,0,0) arc (0:180:1);
        
        %\tdplotsetrotatedcoords{90}{90}{90};
       % \draw[dashed, tdplot_rotated_coords, black] (1,0,0) node {{\Large\bf x}} (0,1,0) node {{\Large\bf y}} (0,0,1) node {{\Large\bf z}}; 
        
        \draw[dashed, gray] (0,0,0) -- (-1,0,0);
        \draw[dashed, gray] (0,0,0) -- (0,-1,0);
        \draw[dashed, gray] (0,0,0) -- (0,0,-1);
        
        \draw[-stealth] (0,0,0) -- (1.30,0,0);
        \draw (1.45,0,0) node {$x$};
        \draw[-stealth] (0,0,0) -- (0,1.30,0);
        \draw(0,1.45,0) node {$y$};
        \draw[-stealth] (0,0,0) -- (0,0,1.30);
        \draw (0,0,1.45) node {$z$};
        
}{%
    \end{tikzpicture}
    \tdplotsetmaincoords{0}{0}
    \egroup
}

\long\def\Exercise#1#2{%
\relax}
\def\QED{\begin{flushright}\ensuremath{\square}\end{flushright}}

% \AtBeginLecture{\frame{\Large \insertlecture}}
%%
%% test
%%
\begin{document}
\include{10}
\end{document}
